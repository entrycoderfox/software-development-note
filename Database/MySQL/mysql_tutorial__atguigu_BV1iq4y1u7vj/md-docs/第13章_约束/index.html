
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="entrycoder的软件开发记事本">
      
      
        <meta name="author" content="entrycoder">
      
      
      
        <link rel="prev" href="../%E7%AC%AC12%E7%AB%A0_MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B2%BE%E8%AE%B2/">
      
      
        <link rel="next" href="../%E7%AC%AC14%E7%AB%A0_%E8%A7%86%E5%9B%BE/">
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.15">
    
    
      
        <title>第13章_约束 - entrycoder的软件开发记事本</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../mkdocs/css/no-footer.css">
    
      <link rel="stylesheet" href="../../../../../mkdocs/css/unordered-list-symbols.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#13-_" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../.." title="entrycoder的软件开发记事本" class="md-header__button md-logo" aria-label="entrycoder的软件开发记事本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            entrycoder的软件开发记事本
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              第13章_约束
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../Environment/" class="md-tabs__link">
        系统环境
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../" class="md-tabs__link md-tabs__link--active">
        数据库
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        关于
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="entrycoder的软件开发记事本" class="md-nav__button md-logo" aria-label="entrycoder的软件开发记事本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    entrycoder的软件开发记事本
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../../Environment/">系统环境</a>
          
            <label for="__nav_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          系统环境
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
          前端
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          前端
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Environment/front_end/vue_on_kylin/" class="md-nav__link">
        在Kylin上安装VUE-CLI等
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../">数据库</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          数据库
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          RDBMS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          RDBMS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" checked>
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
          MySQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_2_1">
          <span class="md-nav__icon md-icon"></span>
          MySQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_1" checked>
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2_1_1" id="__nav_2_2_1_1_label" tabindex="0">
          MySQ教程 尚硅谷
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_2_1_1">
          <span class="md-nav__icon md-icon"></span>
          MySQ教程 尚硅谷
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E4%BD%9C%E8%80%85%E7%9A%84%E8%AF%9D/" class="md-nav__link">
        作者的话
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E4%BF%AE%E6%94%B9%E8%AE%B0%E5%BD%95/" class="md-nav__link">
        修改记录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%9B%AE%E5%BD%95/" class="md-nav__link">
        目录
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1_1_4" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2_1_1_4" id="__nav_2_2_1_1_4_label" tabindex="0">
          文档-基础篇
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_1_1_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_2_1_1_4">
          <span class="md-nav__icon md-icon"></span>
          文档-基础篇
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC00%E7%AB%A0_%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2/" class="md-nav__link">
        第00章_写在前面
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC01%E7%AB%A0_%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%BF%B0/" class="md-nav__link">
        第01章_数据库概述
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC02%E7%AB%A0_MySQL%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="md-nav__link">
        第02章_MySQL环境搭建
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC03%E7%AB%A0_%E5%9F%BA%E6%9C%AC%E7%9A%84SELECT%E8%AF%AD%E5%8F%A5/" class="md-nav__link">
        第03章_基本的SELECT语句
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC04%E7%AB%A0_%E8%BF%90%E7%AE%97%E7%AC%A6/" class="md-nav__link">
        第04章_运算符
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC05%E7%AB%A0_%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%88%86%E9%A1%B5/" class="md-nav__link">
        第05章_排序与分页
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC06%E7%AB%A0_%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2/" class="md-nav__link">
        第06章_多表查询
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC07%E7%AB%A0_%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0/" class="md-nav__link">
        第07章_单行函数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC08%E7%AB%A0_%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0/" class="md-nav__link">
        第08章_聚合函数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC09%E7%AB%A0_%E5%AD%90%E6%9F%A5%E8%AF%A2/" class="md-nav__link">
        第09章_子查询
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC10%E7%AB%A0_%E5%88%9B%E5%BB%BA%E5%92%8C%E7%AE%A1%E7%90%86%E8%A1%A8/" class="md-nav__link">
        第10章_创建和管理表
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC11%E7%AB%A0_%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B9%8B%E5%A2%9E%E5%88%A0%E6%94%B9/" class="md-nav__link">
        第11章_数据处理之增删改
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC12%E7%AB%A0_MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B2%BE%E8%AE%B2/" class="md-nav__link">
        第12章_MySQL数据类型精讲
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          第13章_约束
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        第13章_约束
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#-" class="md-nav__link">
    讲师：尚硅谷-宋红康（江湖人称：康师傅）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#httpwwwatguigucom" class="md-nav__link">
    官网： http://www.atguigu.com
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-constraint" class="md-nav__link">
    1. 约束(constraint)概述
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-1" class="md-nav__link">
    1. 1 为什么需要约束
  </a>
  
    <nav class="md-nav" aria-label="1. 1 为什么需要约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-integrityaccuracyreliability" class="md-nav__link">
    数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    为了保证数据的完整性，SQL规范以约束的方式对 表数据进行额外的条件限制 。从以下四个方面考虑：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entity-integrity" class="md-nav__link">
    实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domain-integrity0-120" class="md-nav__link">
    域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女”
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#referential-integrity" class="md-nav__link">
    引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-defined-integrity" class="md-nav__link">
    用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    经理的工资不得高于本部门职工的平均工资的 5 倍。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-2" class="md-nav__link">
    1. 2 什么是约束
  </a>
  
    <nav class="md-nav" aria-label="1. 2 什么是约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    约束是表级的强制规定。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-table-alter-table" class="md-nav__link">
    可以在 创建表时规定约束（通过 CREATE TABLE 语句） ，或者在 表创建之后通过 ALTER TABLE 语句规定
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    约束 。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-3" class="md-nav__link">
    1. 3 约束的分类
  </a>
  
    <nav class="md-nav" aria-label="1. 3 约束的分类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    根据约束数据列的限制， 约束可分为：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    单列约束 ：每个约束只约束一列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    多列约束 ：每个约束可约束多列数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    根据约束的作用范围 ，约束可分为：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    列级约束 ：只能作用在一个列上，跟在列的定义后面
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    表级约束 ：可以作用在多个列上，不与列一起，而是单独定义
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    根据约束起的作用 ，约束可分为：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-null" class="md-nav__link">
    NOT NULL 非空约束，规定某个字段不能为空
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unique" class="md-nav__link">
    UNIQUE 唯一约束 ， 规定某个字段在整个表中是唯一的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#primary-key" class="md-nav__link">
    PRIMARY KEY 主键(非空且唯一)约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#foreign-key" class="md-nav__link">
    FOREIGN KEY 外键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    CHECK 检查约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default" class="md-nav__link">
    DEFAULT 默认值约束
  </a>
  
    <nav class="md-nav" aria-label="DEFAULT 默认值约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    位置 支持的约束类型 是否可以起约束名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    列级约束： 列的后面 语法都支持，但外键没有效果 不可以
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    表级约束： 所有列的下面 默认和非空不支持，其他支持 可以（主键没有效果）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysqlcheckcheck" class="md-nav__link">
    注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    查看某个表已有的约束
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 非空约束
  </a>
  
    <nav class="md-nav" aria-label="2. 非空约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2-1" class="md-nav__link">
    2. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="2. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    限定某个字段/某列的值不允许为空
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-2" class="md-nav__link">
    2. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="2. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#not-null_1" class="md-nav__link">
    NOT NULL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-3" class="md-nav__link">
    2. 3 特点
  </a>
  
    <nav class="md-nav" aria-label="2. 3 特点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nullintfloat" class="md-nav__link">
    默认，所有的类型的值都可以是NULL，包括INT、FLOAT等数据类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    非空约束只能出现在表对象的列上，只能某个列单独限定非空，不能组合非空
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    一个表可以有很多列都分别限定了非空
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-0-null" class="md-nav__link">
    空字符串''不等于NULL， 0 也不等于NULL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-4" class="md-nav__link">
    2. 4 添加非空约束
  </a>
  
    <nav class="md-nav" aria-label="2. 4 添加非空约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    （ 1 ）建表时
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    举例：
  </a>
  
    <nav class="md-nav" aria-label="举例：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-table" class="md-nav__link">
    CREATE TABLE 表名称(
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    字段名 数据类型,
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-null_2" class="md-nav__link">
    字段名 数据类型 NOT NULL,
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-null_3" class="md-nav__link">
    字段名 数据类型 NOT NULL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    );
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    （ 2 ）建表后
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    举例：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-5" class="md-nav__link">
    2. 5 删除非空约束
  </a>
  
    <nav class="md-nav" aria-label="2. 5 删除非空约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    举例：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 唯一性约束
  </a>
  
    <nav class="md-nav" aria-label="3. 唯一性约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    或
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-1" class="md-nav__link">
    3. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="3. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    用来限制某个字段/某列的值不能重复。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-2" class="md-nav__link">
    3. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="3. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique_1" class="md-nav__link">
    UNIQUE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-3" class="md-nav__link">
    3. 3 特点
  </a>
  
    <nav class="md-nav" aria-label="3. 3 特点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    同一个表可以有多个唯一约束。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    唯一约束可以是某一个列的值唯一，也可以多个列组合的值唯一。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    唯一性约束允许列值为空。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    在创建唯一约束的时候，如果不给唯一约束命名，就默认和列名相同。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql" class="md-nav__link">
    MySQL会给唯一约束的列上默认创建一个唯一索引。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-4" class="md-nav__link">
    3. 4 添加唯一约束
  </a>
  
    <nav class="md-nav" aria-label="3. 4 添加唯一约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    （ 1 ）建表时
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    举例：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    表示用户名和密码组合不能重复
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    （ 2 ）建表后指定唯一键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    举例：
  </a>
  
    <nav class="md-nav" aria-label="举例：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-table-user" class="md-nav__link">
    CREATE TABLE USER(
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    #字段列表中如果是一个字段，表示该列的值唯一。如果是两个或更多个字段，那么复合唯一，即多个字段的组合是唯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    一的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    #方式 1 ：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    #方式 2 ：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-user" class="md-nav__link">
    ALTER TABLE USER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-uniquenamepassword" class="md-nav__link">
    ADD UNIQUE(NAME,PASSWORD);
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    举例：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-5" class="md-nav__link">
    3. 5 关于复合唯一约束
  </a>
  
    <nav class="md-nav" aria-label="3. 5 关于复合唯一约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alter-table-user_1" class="md-nav__link">
    ALTER TABLE USER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-user_2" class="md-nav__link">
    ALTER TABLE USER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-name-varchar-20-unique" class="md-nav__link">
    MODIFY NAME VARCHAR( 20 ) UNIQUE;
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    #学生表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    #课程表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    #选课表
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-5_1" class="md-nav__link">
    3. 5 删除唯一约束
  </a>
  
    <nav class="md-nav" aria-label="3. 5 删除唯一约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    添加唯一性约束的列上也会自动创建唯一索引。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    删除唯一约束只能通过删除唯一索引的方式删除。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    删除时需要指定唯一索引名，唯一索引名就和唯一约束名一样。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同；如果是组合列，那么默认和()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    中排在第一个的列名相同。也可以自定义唯一性约束名。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-index-from" class="md-nav__link">
    注意：可以通过 show index from 表名称;查看表的索引
  </a>
  
    <nav class="md-nav" aria-label="注意：可以通过 show index from 表名称;查看表的索引">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-_1" class="md-nav__link">
    +-----+-------+-------------+--------------------+
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-user_3" class="md-nav__link">
    ALTER TABLE USER
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-primary-key" class="md-nav__link">
    4. PRIMARY KEY 约束
  </a>
  
    <nav class="md-nav" aria-label="4. PRIMARY KEY 约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4-1" class="md-nav__link">
    4. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="4. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    用来唯一标识表中的一行记录。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-2" class="md-nav__link">
    4. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="4. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#primary-key_1" class="md-nav__link">
    primary key
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-3" class="md-nav__link">
    4. 3 特点
  </a>
  
    <nav class="md-nav" aria-label="4. 3 特点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    主键约束相当于 唯一约束+非空约束的组合 ，主键约束列不允许重复，也不允许出现空值。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    一个表最多只能有一个主键约束，建立主键约束可以在列级别创建，也可以在表级别上创建。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    主键约束对应着表中的一列或者多列（复合主键）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    如果是多列组合的复合主键约束，那么这些列都不允许为空值，并且组合的值不允许重复。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysqlprimary" class="md-nav__link">
    MySQL的主键名总是PRIMARY ，就算自己命名了主键约束名也没用。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    当创建主键约束时，系统默认会在所在的列或列组合上建立对应的 主键索引 （能够根据主键查询
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    的，就根据主键查询，效率更高）。如果删除主键约束了，主键约束对应的索引就自动删除了。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    需要注意的一点是，不要修改主键字段的值。因为主键是数据记录的唯一标识，如果修改了主键的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    值，就有可能会破坏数据的完整性。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-4" class="md-nav__link">
    4. 4 添加主键约束
  </a>
  
    <nav class="md-nav" aria-label="4. 4 添加主键约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    （ 1 ）建表时指定主键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    举例：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    再举例：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    列级约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    表级约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    （ 2 ）建表后增加主键约束
  </a>
  
    <nav class="md-nav" aria-label="（ 2 ）建表后增加主键约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    #演示一个表建立两个主键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-add-primary-key" class="md-nav__link">
    ALTER TABLE 表名称 ADD PRIMARY KEY(字段列表); #字段列表可以是一个字段，也可以是多个字段，如果是多
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    个字段的话，是复合主键
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-5" class="md-nav__link">
    4. 5 关于复合主键
  </a>
  
    <nav class="md-nav" aria-label="4. 5 关于复合主键">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    #学生表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_59" class="md-nav__link">
    #课程表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    #选课表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    再举例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-6" class="md-nav__link">
    4. 6 删除主键约束
  </a>
  
    <nav class="md-nav" aria-label="4. 6 删除主键约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    举例：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    说明：删除主键约束，不需要指定主键名，因为一个表只有一个主键，删除主键约束后，非空还存
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    在。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-auto_increment" class="md-nav__link">
    5. 自增列：AUTO_INCREMENT
  </a>
  
    <nav class="md-nav" aria-label="5. 自增列：AUTO_INCREMENT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5-1" class="md-nav__link">
    5. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="5. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_65" class="md-nav__link">
    某个字段的值自增
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-2" class="md-nav__link">
    5. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="5. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#auto_increment" class="md-nav__link">
    auto_increment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-3" class="md-nav__link">
    5. 3 特点和要求
  </a>
  
    <nav class="md-nav" aria-label="5. 3 特点和要求">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    （ 1 ）一个表最多只能有一个自增长列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_5" class="md-nav__link">
    （ 2 ）当需要产生唯一标识符或顺序值时，可设置自增长
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    （ 3 ）自增长列约束的列必须是键列（主键列，唯一键列）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    （ 4 ）自增约束的列的数据类型必须是整数类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-0-null" class="md-nav__link">
    （ 5 ）如果自增列指定了 0 和 null，会在当前最大值的基础上自增；如果自增列手动指定了具体值，直接
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_66" class="md-nav__link">
    赋值为具体值。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_67" class="md-nav__link">
    错误演示：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-4" class="md-nav__link">
    5. 4 如何指定自增约束
  </a>
  
    <nav class="md-nav" aria-label="5. 4 如何指定自增约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    （ 1 ）建表时
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_6" class="md-nav__link">
    （ 2 ）建表后
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_68" class="md-nav__link">
    例如：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-5" class="md-nav__link">
    5. 5 如何删除自增约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-6-mysql-8-0" class="md-nav__link">
    5. 6 MySQL 8. 0 新特性—自增变量的持久化
  </a>
  
    <nav class="md-nav" aria-label="5. 6 MySQL 8. 0 新特性—自增变量的持久化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mysql-80auto_incrementmaxprimary-key1mysql" class="md-nav__link">
    在MySQL 8.0之前，自增主键AUTO_INCREMENT的值如果大于max(primary key)+1，在MySQL重启后，会重
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_incrementmaxprimary-key1" class="md-nav__link">
    置AUTO_INCREMENT=max(primary key)+1，这种现象在某些情况下会导致业务主键冲突或者其他难以发
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-57" class="md-nav__link">
    现的问题。 下面通过案例来对比不同的版本中自增变量是否持久化。 在MySQL 5.7版本中，测试步骤如
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id" class="md-nav__link">
    下： 创建的数据表中包含自增主键的id字段，语句如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    插入 4 个空值，执行如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test1" class="md-nav__link">
    查询数据表test1中的数据，结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id-4" class="md-nav__link">
    删除id为 4 的记录，语句如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_69" class="md-nav__link">
    再次插入一个空值，语句如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test1_1" class="md-nav__link">
    查询此时数据表test1中的数据，结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id-4-4" class="md-nav__link">
    从结果可以看出，虽然删除了id为 4 的记录，但是再次插入空值时，并没有重用被删除的 4 ，而是分配了
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-id-5" class="md-nav__link">
    5 。 删除id为 5 的记录，结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_70" class="md-nav__link">
    重启数据库 ，重新插入一个空值。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test1_2" class="md-nav__link">
    再次查询数据表test1中的数据，结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0-4-6" class="md-nav__link">
    从结果可以看出，新插入的 0 值分配的是 4 ，按照重启前的操作逻辑，此处应该分配 6 。出现上述结果的主
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-5-7-innodb" class="md-nav__link">
    要原因是自增主键没有持久化。 在MySQL 5. 7 系统中，对于自增主键的分配规则，是由InnoDB数据字典
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_71" class="md-nav__link">
    内部一个计数器来决定的，而该计数器只在内存中维护，并不会持久化到磁盘中。当数据库重启时，该
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_72" class="md-nav__link">
    计数器会被初始化。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-8-0" class="md-nav__link">
    在MySQL 8. 0 版本中，上述测试步骤最后一步的结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_73" class="md-nav__link">
    从结果可以看出，自增变量已经持久化了。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-8-0_1" class="md-nav__link">
    MySQL 8. 0 将自增主键的计数器持久化到重做日志中。每次计数器发生改变，都会将其写入重做日志
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#innodb" class="md-nav__link">
    中。如果数据库重启，InnoDB会根据重做日志中的信息来初始化计数器的内存值。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-foreign-key" class="md-nav__link">
    6. FOREIGN KEY 约束
  </a>
  
    <nav class="md-nav" aria-label="6. FOREIGN KEY 约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-1" class="md-nav__link">
    6. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="6. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_74" class="md-nav__link">
    限定某个表的某个字段的引用完整性。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_75" class="md-nav__link">
    比如：员工表的员工所在部门的选择，必须在部门表能找到对应的部分。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-2" class="md-nav__link">
    6. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="6. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#foreign-key_1" class="md-nav__link">
    FOREIGN KEY
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-3" class="md-nav__link">
    6. 3 主表和从表/父表和子表
  </a>
  
    <nav class="md-nav" aria-label="6. 3 主表和从表/父表和子表">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_76" class="md-nav__link">
    主表（父表）：被引用的表，被参考的表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_77" class="md-nav__link">
    从表（子表）：引用别人的表，参考别人的表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_78" class="md-nav__link">
    例如：员工表的员工所在部门这个字段的值要参考部门表：部门表是主表，员工表是从表。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_79" class="md-nav__link">
    例如：学生表、课程表、选课表：选课表的学生和课程要分别参考学生表和课程表，学生表和课程表是
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_80" class="md-nav__link">
    主表，选课表是从表。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-4" class="md-nav__link">
    6. 4 特点
  </a>
  
    <nav class="md-nav" aria-label="6. 4 特点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_6" class="md-nav__link">
    （ 1 ）从表的外键列，必须引用/参考主表的主键或唯一约束的列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_81" class="md-nav__link">
    为什么？因为被依赖/被参考的值必须是唯一的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_7" class="md-nav__link">
    （ 2 ）在创建外键约束时，如果不给外键约束命名， 默认名不是列名，而是自动产生一个外键名 （例如
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#student_ibfk_1" class="md-nav__link">
    student_ibfk_1;），也可以指定外键约束名。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create" class="md-nav__link">
    （ 3 ）创建(CREATE)表时就指定外键约束的话，先创建主表，再创建从表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_2" class="md-nav__link">
    （ 4 ）删表时，先删从表（或先删除外键约束），再删除主表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    （ 5 ）当主表的记录被从表参照时，主表的记录将不允许删除，如果要删除数据，需要先删除从表中依赖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_82" class="md-nav__link">
    该记录的数据，然后才可以删除主表的数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    （ 6 ）在“从表”中指定外键约束，并且一个表可以建立多个外键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    （ 7 ）从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样，逻辑意义一致。如果类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-1005-hy000-cant-create" class="md-nav__link">
    型不一样，创建子表时，就会出现错误“ERROR 1005 (HY000): Can't create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tabledatabasetablenameerrno-150" class="md-nav__link">
    table'database.tablename'(errno: 150)”。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#int" class="md-nav__link">
    例如：都是表示部门编号，都是int类型。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    （ 8 ） 当创建外键约束时，系统默认会在所在的列上建立对应的普通索引 。但是索引名是外键的约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_83" class="md-nav__link">
    名。（根据外键查询效率很高）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    （ 9 ）删除外键约束后，必须手动删除对应的索引
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-5" class="md-nav__link">
    6. 5 添加外键约束
  </a>
  
    <nav class="md-nav" aria-label="6. 5 添加外键约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_7" class="md-nav__link">
    （ 1 ）建表时
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_8" class="md-nav__link">
    （ 2 ）建表后
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_84" class="md-nav__link">
    一般情况下，表与表的关联都是提前设计好了的，因此，会在创建表的时候就把外键约束定义好。不
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_85" class="md-nav__link">
    过，如果需要修改表的设计（比如添加新的字段，增加新的关联关系），但没有预先定义外键约束，那
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_86" class="md-nav__link">
    么，就要用修改表的方式来补充定义。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_87" class="md-nav__link">
    格式：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_88" class="md-nav__link">
    举例：
  </a>
  
    <nav class="md-nav" aria-label="举例：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-foreign-key" class="md-nav__link">
    -- FOREIGN KEY: 在表级指定子表中的列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-references" class="md-nav__link">
    -- REFERENCES: 标示在父表中的列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_89" class="md-nav__link">
    说明：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-add-constraint-foreign-key-references" class="md-nav__link">
    ALTER TABLE 从表名 ADD [CONSTRAINT 约束名] FOREIGN KEY (从表的字段) REFERENCES 主表名(被引用
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_90" class="md-nav__link">
    举例：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-6" class="md-nav__link">
    6. 6 演示问题
  </a>
  
    <nav class="md-nav" aria-label="6. 6 演示问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_8" class="md-nav__link">
    （ 1 ）失败：不是键列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_9" class="md-nav__link">
    （ 2 ）失败：数据类型不一致
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    （ 3 ）成功，两个表字段名一样
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_3" class="md-nav__link">
    （ 4 ）添加、删除、修改问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_91" class="md-nav__link">
    总结：约束关系是针对双方的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_92" class="md-nav__link">
    添加了外键约束后，主表的修改和删除数据受约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_93" class="md-nav__link">
    添加了外键约束后，从表的添加和修改数据受约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_94" class="md-nav__link">
    在从表上建立外键，要求主表必须存在
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_95" class="md-nav__link">
    删除主表时，要求从表从表先删除，或将从表中外键引用该主表的关系先删除
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-7" class="md-nav__link">
    6. 7 约束等级
  </a>
  
    <nav class="md-nav" aria-label="6. 7 约束等级">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cascadeupdatedeleteupdatedelete" class="md-nav__link">
    Cascade方式：在父表上update/delete记录时，同步update/delete掉子表的匹配记录
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-nullupdatedeletenull" class="md-nav__link">
    Set null方式：在父表上update/delete记录时，将子表上匹配记录的列设为null，但是要注意子
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-null_4" class="md-nav__link">
    表的外键列不能为not null
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-actionupdatedelete" class="md-nav__link">
    No action方式：如果子表中有匹配的记录，则不允许对父表对应候选键进行update/delete操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrictno-action" class="md-nav__link">
    Restrict方式：同no action， 都是立即检查外键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-defaultsqlyog" class="md-nav__link">
    Set default方式（在可视化工具SQLyog中可能显示空白）：父表有变更时，子表将外键列设置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#innodb_1" class="md-nav__link">
    成一个默认的值，但Innodb不能识别
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrict" class="md-nav__link">
    如果没有指定等级，就相当于Restrict方式。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-update-cascade-on-delete-restrict" class="md-nav__link">
    对于外键约束，最好是采用: ON UPDATE CASCADE ON DELETE RESTRICT 的方式。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-1-on-update-cascade-on-delete-set-null" class="md-nav__link">
    （ 1 ）演示 1 ：on update cascade on delete set null
  </a>
  
    <nav class="md-nav" aria-label="（ 1 ）演示 1 ：on update cascade on delete set null">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1002-1004-1004" class="md-nav__link">
    #修改主表成功，从表也跟着修改，修改了主表被引用的字段 1002 为 1004 ，从表的引用字段就跟着修改为 1004 了
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC14%E7%AB%A0_%E8%A7%86%E5%9B%BE/" class="md-nav__link">
        第14章_视图
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC15%E7%AB%A0_%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0/" class="md-nav__link">
        第15章_存储过程与函数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC16%E7%AB%A0_%E5%8F%98%E9%87%8F%E3%80%81%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E4%B8%8E%E6%B8%B8%E6%A0%87/" class="md-nav__link">
        第16章_变量、流程控制与游标
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC17%E7%AB%A0_%E8%A7%A6%E5%8F%91%E5%99%A8/" class="md-nav__link">
        第17章_触发器
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC18%E7%AB%A0_MySQL8%E5%85%B6%E5%AE%83%E6%96%B0%E7%89%B9%E6%80%A7/" class="md-nav__link">
        第18章_MySQL8其它新特性
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E7%AC%AC19%E7%AB%A0_%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E/" class="md-nav__link">
        第19章_写在最后
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../..">关于</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          关于
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#-" class="md-nav__link">
    讲师：尚硅谷-宋红康（江湖人称：康师傅）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#httpwwwatguigucom" class="md-nav__link">
    官网： http://www.atguigu.com
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-constraint" class="md-nav__link">
    1. 约束(constraint)概述
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-1" class="md-nav__link">
    1. 1 为什么需要约束
  </a>
  
    <nav class="md-nav" aria-label="1. 1 为什么需要约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-integrityaccuracyreliability" class="md-nav__link">
    数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    为了保证数据的完整性，SQL规范以约束的方式对 表数据进行额外的条件限制 。从以下四个方面考虑：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entity-integrity" class="md-nav__link">
    实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domain-integrity0-120" class="md-nav__link">
    域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女”
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#referential-integrity" class="md-nav__link">
    引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-defined-integrity" class="md-nav__link">
    用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    经理的工资不得高于本部门职工的平均工资的 5 倍。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-2" class="md-nav__link">
    1. 2 什么是约束
  </a>
  
    <nav class="md-nav" aria-label="1. 2 什么是约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    约束是表级的强制规定。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-table-alter-table" class="md-nav__link">
    可以在 创建表时规定约束（通过 CREATE TABLE 语句） ，或者在 表创建之后通过 ALTER TABLE 语句规定
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    约束 。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-3" class="md-nav__link">
    1. 3 约束的分类
  </a>
  
    <nav class="md-nav" aria-label="1. 3 约束的分类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    根据约束数据列的限制， 约束可分为：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    单列约束 ：每个约束只约束一列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    多列约束 ：每个约束可约束多列数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    根据约束的作用范围 ，约束可分为：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    列级约束 ：只能作用在一个列上，跟在列的定义后面
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    表级约束 ：可以作用在多个列上，不与列一起，而是单独定义
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    根据约束起的作用 ，约束可分为：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-null" class="md-nav__link">
    NOT NULL 非空约束，规定某个字段不能为空
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unique" class="md-nav__link">
    UNIQUE 唯一约束 ， 规定某个字段在整个表中是唯一的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#primary-key" class="md-nav__link">
    PRIMARY KEY 主键(非空且唯一)约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#foreign-key" class="md-nav__link">
    FOREIGN KEY 外键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    CHECK 检查约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default" class="md-nav__link">
    DEFAULT 默认值约束
  </a>
  
    <nav class="md-nav" aria-label="DEFAULT 默认值约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    位置 支持的约束类型 是否可以起约束名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    列级约束： 列的后面 语法都支持，但外键没有效果 不可以
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    表级约束： 所有列的下面 默认和非空不支持，其他支持 可以（主键没有效果）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysqlcheckcheck" class="md-nav__link">
    注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    查看某个表已有的约束
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. 非空约束
  </a>
  
    <nav class="md-nav" aria-label="2. 非空约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2-1" class="md-nav__link">
    2. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="2. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    限定某个字段/某列的值不允许为空
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-2" class="md-nav__link">
    2. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="2. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#not-null_1" class="md-nav__link">
    NOT NULL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-3" class="md-nav__link">
    2. 3 特点
  </a>
  
    <nav class="md-nav" aria-label="2. 3 特点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nullintfloat" class="md-nav__link">
    默认，所有的类型的值都可以是NULL，包括INT、FLOAT等数据类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    非空约束只能出现在表对象的列上，只能某个列单独限定非空，不能组合非空
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    一个表可以有很多列都分别限定了非空
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-0-null" class="md-nav__link">
    空字符串''不等于NULL， 0 也不等于NULL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-4" class="md-nav__link">
    2. 4 添加非空约束
  </a>
  
    <nav class="md-nav" aria-label="2. 4 添加非空约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    （ 1 ）建表时
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    举例：
  </a>
  
    <nav class="md-nav" aria-label="举例：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-table" class="md-nav__link">
    CREATE TABLE 表名称(
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    字段名 数据类型,
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-null_2" class="md-nav__link">
    字段名 数据类型 NOT NULL,
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-null_3" class="md-nav__link">
    字段名 数据类型 NOT NULL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    );
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    （ 2 ）建表后
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    举例：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-5" class="md-nav__link">
    2. 5 删除非空约束
  </a>
  
    <nav class="md-nav" aria-label="2. 5 删除非空约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    举例：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3. 唯一性约束
  </a>
  
    <nav class="md-nav" aria-label="3. 唯一性约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    或
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-1" class="md-nav__link">
    3. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="3. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    用来限制某个字段/某列的值不能重复。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-2" class="md-nav__link">
    3. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="3. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique_1" class="md-nav__link">
    UNIQUE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-3" class="md-nav__link">
    3. 3 特点
  </a>
  
    <nav class="md-nav" aria-label="3. 3 特点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    同一个表可以有多个唯一约束。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    唯一约束可以是某一个列的值唯一，也可以多个列组合的值唯一。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    唯一性约束允许列值为空。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    在创建唯一约束的时候，如果不给唯一约束命名，就默认和列名相同。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql" class="md-nav__link">
    MySQL会给唯一约束的列上默认创建一个唯一索引。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-4" class="md-nav__link">
    3. 4 添加唯一约束
  </a>
  
    <nav class="md-nav" aria-label="3. 4 添加唯一约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    （ 1 ）建表时
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    举例：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    表示用户名和密码组合不能重复
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    （ 2 ）建表后指定唯一键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    举例：
  </a>
  
    <nav class="md-nav" aria-label="举例：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-table-user" class="md-nav__link">
    CREATE TABLE USER(
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    #字段列表中如果是一个字段，表示该列的值唯一。如果是两个或更多个字段，那么复合唯一，即多个字段的组合是唯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    一的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    #方式 1 ：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    #方式 2 ：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-user" class="md-nav__link">
    ALTER TABLE USER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-uniquenamepassword" class="md-nav__link">
    ADD UNIQUE(NAME,PASSWORD);
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    举例：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-5" class="md-nav__link">
    3. 5 关于复合唯一约束
  </a>
  
    <nav class="md-nav" aria-label="3. 5 关于复合唯一约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alter-table-user_1" class="md-nav__link">
    ALTER TABLE USER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-user_2" class="md-nav__link">
    ALTER TABLE USER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-name-varchar-20-unique" class="md-nav__link">
    MODIFY NAME VARCHAR( 20 ) UNIQUE;
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    #学生表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    #课程表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    #选课表
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-5_1" class="md-nav__link">
    3. 5 删除唯一约束
  </a>
  
    <nav class="md-nav" aria-label="3. 5 删除唯一约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    添加唯一性约束的列上也会自动创建唯一索引。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    删除唯一约束只能通过删除唯一索引的方式删除。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    删除时需要指定唯一索引名，唯一索引名就和唯一约束名一样。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同；如果是组合列，那么默认和()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    中排在第一个的列名相同。也可以自定义唯一性约束名。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-index-from" class="md-nav__link">
    注意：可以通过 show index from 表名称;查看表的索引
  </a>
  
    <nav class="md-nav" aria-label="注意：可以通过 show index from 表名称;查看表的索引">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-_1" class="md-nav__link">
    +-----+-------+-------------+--------------------+
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-user_3" class="md-nav__link">
    ALTER TABLE USER
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-primary-key" class="md-nav__link">
    4. PRIMARY KEY 约束
  </a>
  
    <nav class="md-nav" aria-label="4. PRIMARY KEY 约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4-1" class="md-nav__link">
    4. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="4. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    用来唯一标识表中的一行记录。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-2" class="md-nav__link">
    4. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="4. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#primary-key_1" class="md-nav__link">
    primary key
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-3" class="md-nav__link">
    4. 3 特点
  </a>
  
    <nav class="md-nav" aria-label="4. 3 特点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    主键约束相当于 唯一约束+非空约束的组合 ，主键约束列不允许重复，也不允许出现空值。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    一个表最多只能有一个主键约束，建立主键约束可以在列级别创建，也可以在表级别上创建。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    主键约束对应着表中的一列或者多列（复合主键）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    如果是多列组合的复合主键约束，那么这些列都不允许为空值，并且组合的值不允许重复。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysqlprimary" class="md-nav__link">
    MySQL的主键名总是PRIMARY ，就算自己命名了主键约束名也没用。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    当创建主键约束时，系统默认会在所在的列或列组合上建立对应的 主键索引 （能够根据主键查询
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    的，就根据主键查询，效率更高）。如果删除主键约束了，主键约束对应的索引就自动删除了。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    需要注意的一点是，不要修改主键字段的值。因为主键是数据记录的唯一标识，如果修改了主键的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    值，就有可能会破坏数据的完整性。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-4" class="md-nav__link">
    4. 4 添加主键约束
  </a>
  
    <nav class="md-nav" aria-label="4. 4 添加主键约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    （ 1 ）建表时指定主键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    举例：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    再举例：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    列级约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    表级约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    （ 2 ）建表后增加主键约束
  </a>
  
    <nav class="md-nav" aria-label="（ 2 ）建表后增加主键约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    #演示一个表建立两个主键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-add-primary-key" class="md-nav__link">
    ALTER TABLE 表名称 ADD PRIMARY KEY(字段列表); #字段列表可以是一个字段，也可以是多个字段，如果是多
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    个字段的话，是复合主键
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-5" class="md-nav__link">
    4. 5 关于复合主键
  </a>
  
    <nav class="md-nav" aria-label="4. 5 关于复合主键">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    #学生表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_59" class="md-nav__link">
    #课程表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    #选课表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    再举例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-6" class="md-nav__link">
    4. 6 删除主键约束
  </a>
  
    <nav class="md-nav" aria-label="4. 6 删除主键约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    举例：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    说明：删除主键约束，不需要指定主键名，因为一个表只有一个主键，删除主键约束后，非空还存
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    在。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-auto_increment" class="md-nav__link">
    5. 自增列：AUTO_INCREMENT
  </a>
  
    <nav class="md-nav" aria-label="5. 自增列：AUTO_INCREMENT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5-1" class="md-nav__link">
    5. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="5. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_65" class="md-nav__link">
    某个字段的值自增
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-2" class="md-nav__link">
    5. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="5. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#auto_increment" class="md-nav__link">
    auto_increment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-3" class="md-nav__link">
    5. 3 特点和要求
  </a>
  
    <nav class="md-nav" aria-label="5. 3 特点和要求">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    （ 1 ）一个表最多只能有一个自增长列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_5" class="md-nav__link">
    （ 2 ）当需要产生唯一标识符或顺序值时，可设置自增长
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    （ 3 ）自增长列约束的列必须是键列（主键列，唯一键列）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    （ 4 ）自增约束的列的数据类型必须是整数类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-0-null" class="md-nav__link">
    （ 5 ）如果自增列指定了 0 和 null，会在当前最大值的基础上自增；如果自增列手动指定了具体值，直接
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_66" class="md-nav__link">
    赋值为具体值。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_67" class="md-nav__link">
    错误演示：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-4" class="md-nav__link">
    5. 4 如何指定自增约束
  </a>
  
    <nav class="md-nav" aria-label="5. 4 如何指定自增约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    （ 1 ）建表时
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_6" class="md-nav__link">
    （ 2 ）建表后
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_68" class="md-nav__link">
    例如：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-5" class="md-nav__link">
    5. 5 如何删除自增约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-6-mysql-8-0" class="md-nav__link">
    5. 6 MySQL 8. 0 新特性—自增变量的持久化
  </a>
  
    <nav class="md-nav" aria-label="5. 6 MySQL 8. 0 新特性—自增变量的持久化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mysql-80auto_incrementmaxprimary-key1mysql" class="md-nav__link">
    在MySQL 8.0之前，自增主键AUTO_INCREMENT的值如果大于max(primary key)+1，在MySQL重启后，会重
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_incrementmaxprimary-key1" class="md-nav__link">
    置AUTO_INCREMENT=max(primary key)+1，这种现象在某些情况下会导致业务主键冲突或者其他难以发
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-57" class="md-nav__link">
    现的问题。 下面通过案例来对比不同的版本中自增变量是否持久化。 在MySQL 5.7版本中，测试步骤如
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id" class="md-nav__link">
    下： 创建的数据表中包含自增主键的id字段，语句如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    插入 4 个空值，执行如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test1" class="md-nav__link">
    查询数据表test1中的数据，结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id-4" class="md-nav__link">
    删除id为 4 的记录，语句如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_69" class="md-nav__link">
    再次插入一个空值，语句如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test1_1" class="md-nav__link">
    查询此时数据表test1中的数据，结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id-4-4" class="md-nav__link">
    从结果可以看出，虽然删除了id为 4 的记录，但是再次插入空值时，并没有重用被删除的 4 ，而是分配了
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-id-5" class="md-nav__link">
    5 。 删除id为 5 的记录，结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_70" class="md-nav__link">
    重启数据库 ，重新插入一个空值。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test1_2" class="md-nav__link">
    再次查询数据表test1中的数据，结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#0-4-6" class="md-nav__link">
    从结果可以看出，新插入的 0 值分配的是 4 ，按照重启前的操作逻辑，此处应该分配 6 。出现上述结果的主
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-5-7-innodb" class="md-nav__link">
    要原因是自增主键没有持久化。 在MySQL 5. 7 系统中，对于自增主键的分配规则，是由InnoDB数据字典
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_71" class="md-nav__link">
    内部一个计数器来决定的，而该计数器只在内存中维护，并不会持久化到磁盘中。当数据库重启时，该
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_72" class="md-nav__link">
    计数器会被初始化。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-8-0" class="md-nav__link">
    在MySQL 8. 0 版本中，上述测试步骤最后一步的结果如下：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_73" class="md-nav__link">
    从结果可以看出，自增变量已经持久化了。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-8-0_1" class="md-nav__link">
    MySQL 8. 0 将自增主键的计数器持久化到重做日志中。每次计数器发生改变，都会将其写入重做日志
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#innodb" class="md-nav__link">
    中。如果数据库重启，InnoDB会根据重做日志中的信息来初始化计数器的内存值。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-foreign-key" class="md-nav__link">
    6. FOREIGN KEY 约束
  </a>
  
    <nav class="md-nav" aria-label="6. FOREIGN KEY 约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-1" class="md-nav__link">
    6. 1 作用
  </a>
  
    <nav class="md-nav" aria-label="6. 1 作用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_74" class="md-nav__link">
    限定某个表的某个字段的引用完整性。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_75" class="md-nav__link">
    比如：员工表的员工所在部门的选择，必须在部门表能找到对应的部分。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-2" class="md-nav__link">
    6. 2 关键字
  </a>
  
    <nav class="md-nav" aria-label="6. 2 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#foreign-key_1" class="md-nav__link">
    FOREIGN KEY
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-3" class="md-nav__link">
    6. 3 主表和从表/父表和子表
  </a>
  
    <nav class="md-nav" aria-label="6. 3 主表和从表/父表和子表">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_76" class="md-nav__link">
    主表（父表）：被引用的表，被参考的表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_77" class="md-nav__link">
    从表（子表）：引用别人的表，参考别人的表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_78" class="md-nav__link">
    例如：员工表的员工所在部门这个字段的值要参考部门表：部门表是主表，员工表是从表。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_79" class="md-nav__link">
    例如：学生表、课程表、选课表：选课表的学生和课程要分别参考学生表和课程表，学生表和课程表是
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_80" class="md-nav__link">
    主表，选课表是从表。
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-4" class="md-nav__link">
    6. 4 特点
  </a>
  
    <nav class="md-nav" aria-label="6. 4 特点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_6" class="md-nav__link">
    （ 1 ）从表的外键列，必须引用/参考主表的主键或唯一约束的列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_81" class="md-nav__link">
    为什么？因为被依赖/被参考的值必须是唯一的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_7" class="md-nav__link">
    （ 2 ）在创建外键约束时，如果不给外键约束命名， 默认名不是列名，而是自动产生一个外键名 （例如
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#student_ibfk_1" class="md-nav__link">
    student_ibfk_1;），也可以指定外键约束名。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create" class="md-nav__link">
    （ 3 ）创建(CREATE)表时就指定外键约束的话，先创建主表，再创建从表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_2" class="md-nav__link">
    （ 4 ）删表时，先删从表（或先删除外键约束），再删除主表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    （ 5 ）当主表的记录被从表参照时，主表的记录将不允许删除，如果要删除数据，需要先删除从表中依赖
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_82" class="md-nav__link">
    该记录的数据，然后才可以删除主表的数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    （ 6 ）在“从表”中指定外键约束，并且一个表可以建立多个外键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    （ 7 ）从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样，逻辑意义一致。如果类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-1005-hy000-cant-create" class="md-nav__link">
    型不一样，创建子表时，就会出现错误“ERROR 1005 (HY000): Can't create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tabledatabasetablenameerrno-150" class="md-nav__link">
    table'database.tablename'(errno: 150)”。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#int" class="md-nav__link">
    例如：都是表示部门编号，都是int类型。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    （ 8 ） 当创建外键约束时，系统默认会在所在的列上建立对应的普通索引 。但是索引名是外键的约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_83" class="md-nav__link">
    名。（根据外键查询效率很高）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    （ 9 ）删除外键约束后，必须手动删除对应的索引
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-5" class="md-nav__link">
    6. 5 添加外键约束
  </a>
  
    <nav class="md-nav" aria-label="6. 5 添加外键约束">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_7" class="md-nav__link">
    （ 1 ）建表时
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_8" class="md-nav__link">
    （ 2 ）建表后
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_84" class="md-nav__link">
    一般情况下，表与表的关联都是提前设计好了的，因此，会在创建表的时候就把外键约束定义好。不
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_85" class="md-nav__link">
    过，如果需要修改表的设计（比如添加新的字段，增加新的关联关系），但没有预先定义外键约束，那
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_86" class="md-nav__link">
    么，就要用修改表的方式来补充定义。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_87" class="md-nav__link">
    格式：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_88" class="md-nav__link">
    举例：
  </a>
  
    <nav class="md-nav" aria-label="举例：">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-foreign-key" class="md-nav__link">
    -- FOREIGN KEY: 在表级指定子表中的列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-references" class="md-nav__link">
    -- REFERENCES: 标示在父表中的列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_89" class="md-nav__link">
    说明：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table-add-constraint-foreign-key-references" class="md-nav__link">
    ALTER TABLE 从表名 ADD [CONSTRAINT 约束名] FOREIGN KEY (从表的字段) REFERENCES 主表名(被引用
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_90" class="md-nav__link">
    举例：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-6" class="md-nav__link">
    6. 6 演示问题
  </a>
  
    <nav class="md-nav" aria-label="6. 6 演示问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_8" class="md-nav__link">
    （ 1 ）失败：不是键列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_9" class="md-nav__link">
    （ 2 ）失败：数据类型不一致
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    （ 3 ）成功，两个表字段名一样
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_3" class="md-nav__link">
    （ 4 ）添加、删除、修改问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_91" class="md-nav__link">
    总结：约束关系是针对双方的
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_92" class="md-nav__link">
    添加了外键约束后，主表的修改和删除数据受约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_93" class="md-nav__link">
    添加了外键约束后，从表的添加和修改数据受约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_94" class="md-nav__link">
    在从表上建立外键，要求主表必须存在
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_95" class="md-nav__link">
    删除主表时，要求从表从表先删除，或将从表中外键引用该主表的关系先删除
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-7" class="md-nav__link">
    6. 7 约束等级
  </a>
  
    <nav class="md-nav" aria-label="6. 7 约束等级">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cascadeupdatedeleteupdatedelete" class="md-nav__link">
    Cascade方式：在父表上update/delete记录时，同步update/delete掉子表的匹配记录
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-nullupdatedeletenull" class="md-nav__link">
    Set null方式：在父表上update/delete记录时，将子表上匹配记录的列设为null，但是要注意子
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-null_4" class="md-nav__link">
    表的外键列不能为not null
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-actionupdatedelete" class="md-nav__link">
    No action方式：如果子表中有匹配的记录，则不允许对父表对应候选键进行update/delete操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrictno-action" class="md-nav__link">
    Restrict方式：同no action， 都是立即检查外键约束
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-defaultsqlyog" class="md-nav__link">
    Set default方式（在可视化工具SQLyog中可能显示空白）：父表有变更时，子表将外键列设置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#innodb_1" class="md-nav__link">
    成一个默认的值，但Innodb不能识别
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrict" class="md-nav__link">
    如果没有指定等级，就相当于Restrict方式。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-update-cascade-on-delete-restrict" class="md-nav__link">
    对于外键约束，最好是采用: ON UPDATE CASCADE ON DELETE RESTRICT 的方式。
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-1-on-update-cascade-on-delete-set-null" class="md-nav__link">
    （ 1 ）演示 1 ：on update cascade on delete set null
  </a>
  
    <nav class="md-nav" aria-label="（ 1 ）演示 1 ：on update cascade on delete set null">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1002-1004-1004" class="md-nav__link">
    #修改主表成功，从表也跟着修改，修改了主表被引用的字段 1002 为 1004 ，从表的引用字段就跟着修改为 1004 了
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  




<h1 id="13-_">第 13 章_约束<a class="headerlink" href="#13-_" title="Permanent link">&para;</a></h1>
<h4 id="-">讲师：尚硅谷-宋红康（江湖人称：康师傅）<a class="headerlink" href="#-" title="Permanent link">&para;</a></h4>
<h4 id="httpwwwatguigucom">官网： http://www.atguigu.com<a class="headerlink" href="#httpwwwatguigucom" title="Permanent link">&para;</a></h4>
<h2 id="1-constraint">1. 约束(constraint)概述<a class="headerlink" href="#1-constraint" title="Permanent link">&para;</a></h2>
<h2 id="1-1">1. 1 为什么需要约束<a class="headerlink" href="#1-1" title="Permanent link">&para;</a></h2>
<h4 id="data-integrityaccuracyreliability">数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中<a class="headerlink" href="#data-integrityaccuracyreliability" title="Permanent link">&para;</a></h4>
<h4 id="_1">存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<h4 id="sql">为了保证数据的完整性，SQL规范以约束的方式对 表数据进行额外的条件限制 。从以下四个方面考虑：<a class="headerlink" href="#sql" title="Permanent link">&para;</a></h4>
<h4 id="entity-integrity">实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录<a class="headerlink" href="#entity-integrity" title="Permanent link">&para;</a></h4>
<h4 id="domain-integrity0-120">域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女”<a class="headerlink" href="#domain-integrity0-120" title="Permanent link">&para;</a></h4>
<h4 id="referential-integrity">引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门<a class="headerlink" href="#referential-integrity" title="Permanent link">&para;</a></h4>
<h4 id="user-defined-integrity">用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门<a class="headerlink" href="#user-defined-integrity" title="Permanent link">&para;</a></h4>
<h4 id="5">经理的工资不得高于本部门职工的平均工资的 5 倍。<a class="headerlink" href="#5" title="Permanent link">&para;</a></h4>
<h2 id="1-2">1. 2 什么是约束<a class="headerlink" href="#1-2" title="Permanent link">&para;</a></h2>
<h4 id="_2">约束是表级的强制规定。<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<h4 id="create-table-alter-table">可以在 创建表时规定约束（通过 CREATE TABLE 语句） ，或者在 表创建之后通过 ALTER TABLE 语句规定<a class="headerlink" href="#create-table-alter-table" title="Permanent link">&para;</a></h4>
<h4 id="_3">约束 。<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<h2 id="1-3">1. 3 约束的分类<a class="headerlink" href="#1-3" title="Permanent link">&para;</a></h2>
<h4 id="_4">根据约束数据列的限制， 约束可分为：<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<h4 id="_5">单列约束 ：每个约束只约束一列<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<h4 id="_6">多列约束 ：每个约束可约束多列数据<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<h4 id="_7">根据约束的作用范围 ，约束可分为：<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<h4 id="_8">列级约束 ：只能作用在一个列上，跟在列的定义后面<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<h4 id="_9">表级约束 ：可以作用在多个列上，不与列一起，而是单独定义<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<h4 id="_10">根据约束起的作用 ，约束可分为：<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<h4 id="not-null">NOT NULL 非空约束，规定某个字段不能为空<a class="headerlink" href="#not-null" title="Permanent link">&para;</a></h4>
<h4 id="unique">UNIQUE 唯一约束 ， 规定某个字段在整个表中是唯一的<a class="headerlink" href="#unique" title="Permanent link">&para;</a></h4>
<h4 id="primary-key">PRIMARY KEY 主键(非空且唯一)约束<a class="headerlink" href="#primary-key" title="Permanent link">&para;</a></h4>
<h4 id="foreign-key">FOREIGN KEY 外键约束<a class="headerlink" href="#foreign-key" title="Permanent link">&para;</a></h4>
<h4 id="check">CHECK 检查约束<a class="headerlink" href="#check" title="Permanent link">&para;</a></h4>
<h4 id="default">DEFAULT 默认值约束<a class="headerlink" href="#default" title="Permanent link">&para;</a></h4>
<h5 id="_11">位置 支持的约束类型 是否可以起约束名<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h5>
<h5 id="_12">列级约束： 列的后面 语法都支持，但外键没有效果 不可以<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h5>
<h5 id="_13">表级约束： 所有列的下面 默认和非空不支持，其他支持 可以（主键没有效果）<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h5>
<h4 id="mysqlcheckcheck">注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果<a class="headerlink" href="#mysqlcheckcheck" title="Permanent link">&para;</a></h4>
<h4 id="_14">查看某个表已有的约束<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<h2 id="2">2. 非空约束<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="2-1">2. 1 作用<a class="headerlink" href="#2-1" title="Permanent link">&para;</a></h3>
<h4 id="_15">限定某个字段/某列的值不允许为空<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<h3 id="2-2">2. 2 关键字<a class="headerlink" href="#2-2" title="Permanent link">&para;</a></h3>
<h4 id="not-null_1">NOT NULL<a class="headerlink" href="#not-null_1" title="Permanent link">&para;</a></h4>
<h3 id="2-3">2. 3 特点<a class="headerlink" href="#2-3" title="Permanent link">&para;</a></h3>
<h4 id="nullintfloat">默认，所有的类型的值都可以是NULL，包括INT、FLOAT等数据类型<a class="headerlink" href="#nullintfloat" title="Permanent link">&para;</a></h4>
<h4 id="_16">非空约束只能出现在表对象的列上，只能某个列单独限定非空，不能组合非空<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<h4 id="_17">一个表可以有很多列都分别限定了非空<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h4>
<h4 id="null-0-null">空字符串''不等于NULL， 0 也不等于NULL<a class="headerlink" href="#null-0-null" title="Permanent link">&para;</a></h4>
<h3 id="2-4">2. 4 添加非空约束<a class="headerlink" href="#2-4" title="Permanent link">&para;</a></h3>
<h4 id="1">（ 1 ）建表时<a class="headerlink" href="#1" title="Permanent link">&para;</a></h4>
<h4 id="_18">举例：<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>#information_schema数据库名（系统库）
#table_constraints表名称（专门存储各个表的约束）
SELECT * FROM information_schema.table_constraints
WHERE table_name = &#39;表名称&#39;;
</code></pre></div>
<h5 id="create-table">CREATE TABLE 表名称(<a class="headerlink" href="#create-table" title="Permanent link">&para;</a></h5>
<h5 id="_19">字段名 数据类型,<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h5>
<h5 id="not-null_2">字段名 数据类型 NOT NULL,<a class="headerlink" href="#not-null_2" title="Permanent link">&para;</a></h5>
<h5 id="not-null_3">字段名 数据类型 NOT NULL<a class="headerlink" href="#not-null_3" title="Permanent link">&para;</a></h5>
<h5 id="_20">);<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h5>
<h4 id="2_1">（ 2 ）建表后<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h4>
<h4 id="_21">举例：<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<h3 id="2-5">2. 5 删除非空约束<a class="headerlink" href="#2-5" title="Permanent link">&para;</a></h3>
<h4 id="_22">举例：<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<h2 id="3">3. 唯一性约束<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>CREATE TABLE emp(
id INT( 10 ) NOT NULL,
NAME VARCHAR( 20 ) NOT NULL,
sex CHAR NULL
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>CREATE TABLE student(
sid int,
sname varchar( 20 ) not null,
tel char( 11 ) ,
cardid char( 18 ) not null
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student values( 1 ,&#39;张三&#39;,&#39;13710011002&#39;,&#39;110222198912032545&#39;); #成功
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student values( 2 ,&#39;李四&#39;,&#39;13710011002&#39;,null);#身份证号为空
ERROR 1048 ( 23000 ): Column &#39;cardid&#39; cannot be null
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student values( 2 ,&#39;李四&#39;,null,&#39;110222198912032546&#39;);#成功，tel允许为空
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student values( 3 ,null,null,&#39;110222198912032547&#39;);#失败
ERROR 1048 ( 23000 ): Column &#39;sname&#39; cannot be null
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table 表名称 modify 字段名 数据类型 not null;
</code></pre></div>
<div class="highlight"><pre><span></span><code>ALTER TABLE emp
MODIFY sex VARCHAR( 30 ) NOT NULL;
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table student modify sname varchar( 20 ) not null;
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table 表名称 modify 字段名 数据类型 NULL;#去掉not null，相当于修改某个非注解字段，该字段允
许为空
</code></pre></div>
<h5 id="_23">或<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>alter table 表名称 modify 字段名 数据类型;#去掉not null，相当于修改某个非注解字段，该字段允许为空
</code></pre></div>
<div class="highlight"><pre><span></span><code>ALTER TABLE emp
MODIFY sex VARCHAR( 30 ) NULL;
</code></pre></div>
<div class="highlight"><pre><span></span><code>ALTER TABLE emp
MODIFY NAME VARCHAR( 15 ) DEFAULT &#39;abc&#39; NULL;
</code></pre></div>
<h3 id="3-1">3. 1 作用<a class="headerlink" href="#3-1" title="Permanent link">&para;</a></h3>
<h4 id="_24">用来限制某个字段/某列的值不能重复。<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h4>
<h3 id="3-2">3. 2 关键字<a class="headerlink" href="#3-2" title="Permanent link">&para;</a></h3>
<h4 id="unique_1">UNIQUE<a class="headerlink" href="#unique_1" title="Permanent link">&para;</a></h4>
<h3 id="3-3">3. 3 特点<a class="headerlink" href="#3-3" title="Permanent link">&para;</a></h3>
<h4 id="_25">同一个表可以有多个唯一约束。<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<h4 id="_26">唯一约束可以是某一个列的值唯一，也可以多个列组合的值唯一。<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<h4 id="_27">唯一性约束允许列值为空。<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h4>
<h4 id="_28">在创建唯一约束的时候，如果不给唯一约束命名，就默认和列名相同。<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h4>
<h4 id="mysql">MySQL会给唯一约束的列上默认创建一个唯一索引。<a class="headerlink" href="#mysql" title="Permanent link">&para;</a></h4>
<h3 id="3-4">3. 4 添加唯一约束<a class="headerlink" href="#3-4" title="Permanent link">&para;</a></h3>
<h4 id="1_1">（ 1 ）建表时<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h4>
<h4 id="_29">举例：<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>create table 表名称(
字段名 数据类型,
字段名 数据类型 unique,
字段名 数据类型 unique key,
字段名 数据类型
);
create table 表名称(
字段名 数据类型,
字段名 数据类型,
字段名 数据类型,
[constraint 约束名] unique key(字段名)
);
</code></pre></div>
<h4 id="_30">表示用户名和密码组合不能重复<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h4>
<h4 id="2_2">（ 2 ）建表后指定唯一键约束<a class="headerlink" href="#2_2" title="Permanent link">&para;</a></h4>
<h4 id="_31">举例：<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>create table student(
sid int,
sname varchar( 20 ),
tel char( 11 ) unique,
cardid char( 18 ) unique key
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>CREATE TABLE t_course(
cid INT UNIQUE,
cname VARCHAR( 100 ) UNIQUE,
description VARCHAR( 200 )
);
</code></pre></div>
<h5 id="create-table-user">CREATE TABLE USER(<a class="headerlink" href="#create-table-user" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>id INT NOT NULL,
NAME VARCHAR( 25 ),
PASSWORD VARCHAR( 16 ),
-- 使用表级约束语法
CONSTRAINT uk_name_pwd UNIQUE(NAME,PASSWORD)
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student values( 1 ,&#39;张三&#39;,&#39;13710011002&#39;,&#39;101223199012015623&#39;);
insert into student values( 2 ,&#39;李四&#39;,&#39;13710011003&#39;,&#39;101223199012015624&#39;);
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from student;
+-----+-------+-------------+--------------------+
| sid | sname | tel | cardid |
+-----+-------+-------------+--------------------+
| 1 | 张三 | 13710011002 | 101223199012015623 |
| 2 | 李四 | 13710011003 | 101223199012015624 |
+-----+-------+-------------+--------------------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student values( 3 ,&#39;王五&#39;,&#39;13710011004&#39;,&#39;101223199012015624&#39;); #身份证号重复
ERROR 1062 ( 23000 ): Duplicate entry &#39;101223199012015624&#39; for key &#39;cardid&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student values( 3 ,&#39;王五&#39;,&#39;13710011003&#39;,&#39;101223199012015625&#39;);
ERROR 1062 ( 23000 ): Duplicate entry &#39;13710011003&#39; for key &#39;tel&#39;
</code></pre></div>
<h5 id="_32">#字段列表中如果是一个字段，表示该列的值唯一。如果是两个或更多个字段，那么复合唯一，即多个字段的组合是唯<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h5>
<h5 id="_33">一的<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h5>
<h5 id="1_2">#方式 1 ：<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>alter table 表名称 add unique key(字段列表);
</code></pre></div>
<h5 id="2_3">#方式 2 ：<a class="headerlink" href="#2_3" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>alter table 表名称 modify 字段名 字段类型 unique;
</code></pre></div>
<h5 id="alter-table-user">ALTER TABLE USER<a class="headerlink" href="#alter-table-user" title="Permanent link">&para;</a></h5>
<h5 id="add-uniquenamepassword">ADD UNIQUE(NAME,PASSWORD);<a class="headerlink" href="#add-uniquenamepassword" title="Permanent link">&para;</a></h5>
<h4 id="_34">举例：<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h4>
<h3 id="3-5">3. 5 关于复合唯一约束<a class="headerlink" href="#3-5" title="Permanent link">&para;</a></h3>
<h5 id="alter-table-user_1">ALTER TABLE USER<a class="headerlink" href="#alter-table-user_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>ADD CONSTRAINT uk_name_pwd UNIQUE(NAME,PASSWORD);
</code></pre></div>
<h5 id="alter-table-user_2">ALTER TABLE USER<a class="headerlink" href="#alter-table-user_2" title="Permanent link">&para;</a></h5>
<h5 id="modify-name-varchar-20-unique">MODIFY NAME VARCHAR( 20 ) UNIQUE;<a class="headerlink" href="#modify-name-varchar-20-unique" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table student(
sid int primary key,
sname varchar( 20 ),
tel char( 11 ) ,
cardid char( 18 )
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table student add unique key(tel);
alter table student add unique key(cardid);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table 表名称(
字段名 数据类型,
字段名 数据类型,
字段名 数据类型,
unique key(字段列表) #字段列表中写的是多个字段名，多个字段名用逗号分隔，表示那么是复合唯一，即多
个字段的组合是唯一的
);
</code></pre></div>
<h5 id="_35">#学生表<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table student(
sid int, #学号
sname varchar( 20 ), #姓名
tel char( 11 ) unique key,  #电话
cardid char( 18 ) unique key #身份证号
);
</code></pre></div>
<h5 id="_36">#课程表<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table course(
cid int,  #课程编号
cname varchar( 20 ) #课程名称
);
</code></pre></div>
<h5 id="_37">#选课表<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table student_course(
id int,
sid int,
cid int,
score int,
unique key(sid,cid)  #复合唯一
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student values( 1 ,&#39;张三&#39;,&#39;13710011002&#39;,&#39;101223199012015623&#39;);#成功
insert into student values( 2 ,&#39;李四&#39;,&#39;13710011003&#39;,&#39;101223199012015624&#39;);#成功
insert into course values( 1001 ,&#39;Java&#39;),( 1002 ,&#39;MySQL&#39;);#成功
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from student;
</code></pre></div>
<h3 id="3-5_1">3. 5 删除唯一约束<a class="headerlink" href="#3-5_1" title="Permanent link">&para;</a></h3>
<h4 id="_38">添加唯一性约束的列上也会自动创建唯一索引。<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h4>
<h4 id="_39">删除唯一约束只能通过删除唯一索引的方式删除。<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h4>
<h4 id="_40">删除时需要指定唯一索引名，唯一索引名就和唯一约束名一样。<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h4>
<h4 id="_41">如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同；如果是组合列，那么默认和()<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h4>
<h4 id="_42">中排在第一个的列名相同。也可以自定义唯一性约束名。<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h4>
<h4 id="show-index-from">注意：可以通过 show index from 表名称;查看表的索引<a class="headerlink" href="#show-index-from" title="Permanent link">&para;</a></h4>
<h5 id="-_1">+-----+-------+-------------+--------------------+<a class="headerlink" href="#-_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>| sid | sname | tel | cardid |
+-----+-------+-------------+--------------------+
| 1 | 张三 | 13710011002 | 101223199012015623 |
| 2 | 李四 | 13710011003 | 101223199012015624 |
+-----+-------+-------------+--------------------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from course;
+------+-------+
| cid | cname |
+------+-------+
| 1001 | Java |
| 1002 | MySQL |
+------+-------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student_course values
( 1 , 1 , 1001 , 89 ),
( 2 , 1 , 1002 , 90 ),
( 3 , 2 , 1001 , 88 ),
( 4 , 2 , 1002 , 56 );#成功
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from student_course;
+----+------+------+-------+
| id | sid | cid | score |
+----+------+------+-------+
| 1 | 1 | 1001 | 89 |
| 2 | 1 | 1002 | 90 |
| 3 | 2 | 1001 | 88 |
| 4 | 2 | 1002 | 56 |
+----+------+------+-------+
4 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student_course values ( 5 , 1 , 1001 , 88 );#失败
</code></pre></div>
<div class="highlight"><pre><span></span><code>#ERROR 1062 (23000): Duplicate entry &#39;1-1001&#39; for key &#39;sid&#39; 违反sid-cid的复合唯一
</code></pre></div>
<div class="highlight"><pre><span></span><code>SELECT * FROM information_schema.table_constraints WHERE table_name = &#39;表名&#39;; #查看都有哪
些约束
</code></pre></div>
<h5 id="alter-table-user_3">ALTER TABLE USER<a class="headerlink" href="#alter-table-user_3" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>DROP INDEX uk_name_pwd;
</code></pre></div>
<h2 id="4-primary-key">4. PRIMARY KEY 约束<a class="headerlink" href="#4-primary-key" title="Permanent link">&para;</a></h2>
<h3 id="4-1">4. 1 作用<a class="headerlink" href="#4-1" title="Permanent link">&para;</a></h3>
<h4 id="_43">用来唯一标识表中的一行记录。<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h4>
<h3 id="4-2">4. 2 关键字<a class="headerlink" href="#4-2" title="Permanent link">&para;</a></h3>
<h4 id="primary-key_1">primary key<a class="headerlink" href="#primary-key_1" title="Permanent link">&para;</a></h4>
<h3 id="4-3">4. 3 特点<a class="headerlink" href="#4-3" title="Permanent link">&para;</a></h3>
<h4 id="_44">主键约束相当于 唯一约束+非空约束的组合 ，主键约束列不允许重复，也不允许出现空值。<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h4>
<h4 id="_45">一个表最多只能有一个主键约束，建立主键约束可以在列级别创建，也可以在表级别上创建。<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h4>
<h4 id="_46">主键约束对应着表中的一列或者多列（复合主键）<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h4>
<h4 id="_47">如果是多列组合的复合主键约束，那么这些列都不允许为空值，并且组合的值不允许重复。<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h4>
<h4 id="mysqlprimary">MySQL的主键名总是PRIMARY ，就算自己命名了主键约束名也没用。<a class="headerlink" href="#mysqlprimary" title="Permanent link">&para;</a></h4>
<h4 id="_48">当创建主键约束时，系统默认会在所在的列或列组合上建立对应的 主键索引 （能够根据主键查询<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h4>
<h4 id="_49">的，就根据主键查询，效率更高）。如果删除主键约束了，主键约束对应的索引就自动删除了。<a class="headerlink" href="#_49" title="Permanent link">&para;</a></h4>
<h4 id="_50">需要注意的一点是，不要修改主键字段的值。因为主键是数据记录的唯一标识，如果修改了主键的<a class="headerlink" href="#_50" title="Permanent link">&para;</a></h4>
<h4 id="_51">值，就有可能会破坏数据的完整性。<a class="headerlink" href="#_51" title="Permanent link">&para;</a></h4>
<h3 id="4-4">4. 4 添加主键约束<a class="headerlink" href="#4-4" title="Permanent link">&para;</a></h3>
<h4 id="1_3">（ 1 ）建表时指定主键约束<a class="headerlink" href="#1_3" title="Permanent link">&para;</a></h4>
<h4 id="_52">举例：<a class="headerlink" href="#_52" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>create table 表名称(
字段名 数据类型 primary key, #列级模式
字段名 数据类型,
字段名 数据类型
);
create table 表名称(
字段名 数据类型,
字段名 数据类型,
字段名 数据类型,
[constraint 约束名] primary key(字段名) #表级模式
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table temp(
id int primary key,
name varchar( 20 )
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; desc temp;
+-------+-------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| id | int( 11 ) | NO | PRI | NULL | |
| name | varchar( 20 ) | YES | | NULL | |
+-------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into temp values( 1 ,&#39;张三&#39;);#成功
insert into temp values( 2 ,&#39;李四&#39;);#成功
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from temp;
+----+------+
| id | name |
+----+------+
| 1 | 张三 |
| 2 | 李四 |
+----+------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into temp values( 1 ,&#39;张三&#39;);#失败
ERROR 1062 ( 23000 ): Duplicate（重复） entry（键入，输入） &#39;1&#39; for key &#39;PRIMARY&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into temp values( 1 ,&#39;王五&#39;);#失败
ERROR 1062 ( 23000 ): Duplicate entry &#39;1&#39; for key &#39;PRIMARY&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into temp values( 3 ,&#39;张三&#39;);#成功
</code></pre></div>
<h4 id="_53">再举例：<a class="headerlink" href="#_53" title="Permanent link">&para;</a></h4>
<h4 id="_54">列级约束<a class="headerlink" href="#_54" title="Permanent link">&para;</a></h4>
<h4 id="_55">表级约束<a class="headerlink" href="#_55" title="Permanent link">&para;</a></h4>
<h4 id="2_4">（ 2 ）建表后增加主键约束<a class="headerlink" href="#2_4" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from temp;
+----+------+
| id | name |
+----+------+
| 1 | 张三 |
| 2 | 李四 |
| 3 | 张三 |
+----+------+
3 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into temp values( 4 ,null);#成功
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into temp values(null,&#39;李琦&#39;);#失败
ERROR 1048 ( 23000 ): Column &#39;id&#39; cannot be null
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from temp;
+----+------+
| id | name |
+----+------+
| 1 | 张三 |
| 2 | 李四 |
| 3 | 张三 |
| 4 | NULL |
+----+------+
4 rows in set (0.00 sec)
</code></pre></div>
<h5 id="_56">#演示一个表建立两个主键约束<a class="headerlink" href="#_56" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table temp(
id int primary key,
name varchar( 20 ) primary key
);
ERROR 1068 ( 42000 ): Multiple（多重的） primary key defined（定义）
</code></pre></div>
<div class="highlight"><pre><span></span><code>CREATE TABLE emp4(
id INT PRIMARY KEY AUTO_INCREMENT ,
NAME VARCHAR( 20 )
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>CREATE TABLE emp5(
id INT NOT NULL AUTO_INCREMENT,
NAME VARCHAR( 20 ),
pwd VARCHAR( 15 ),
CONSTRAINT emp5_id_pk PRIMARY KEY(id)
);
</code></pre></div>
<h5 id="alter-table-add-primary-key">ALTER TABLE 表名称 ADD PRIMARY KEY(字段列表); #字段列表可以是一个字段，也可以是多个字段，如果是多<a class="headerlink" href="#alter-table-add-primary-key" title="Permanent link">&para;</a></h5>
<h5 id="_57">个字段的话，是复合主键<a class="headerlink" href="#_57" title="Permanent link">&para;</a></h5>
<h3 id="4-5">4. 5 关于复合主键<a class="headerlink" href="#4-5" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>ALTER TABLE student ADD PRIMARY KEY (sid);
</code></pre></div>
<div class="highlight"><pre><span></span><code>ALTER TABLE emp5 ADD PRIMARY KEY(NAME,pwd);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table 表名称(
字段名 数据类型,
字段名 数据类型,
字段名 数据类型,
primary key(字段名1,字段名2)  #表示字段 1 和字段 2 的组合是唯一的，也可以有更多个字段
);
</code></pre></div>
<h5 id="_58">#学生表<a class="headerlink" href="#_58" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table student(
sid int primary key,  #学号
sname varchar( 20 ) #学生姓名
);
</code></pre></div>
<h5 id="_59">#课程表<a class="headerlink" href="#_59" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table course(
cid int primary key,  #课程编号
cname varchar( 20 ) #课程名称
);
</code></pre></div>
<h5 id="_60">#选课表<a class="headerlink" href="#_60" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table student_course(
sid int,
cid int,
score int,
primary key(sid,cid)  #复合主键
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student values( 1 ,&#39;张三&#39;),( 2 ,&#39;李四&#39;);
insert into course values( 1001 ,&#39;Java&#39;),( 1002 ,&#39;MySQL&#39;);
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from student;
+-----+-------+
| sid | sname |
+-----+-------+
| 1 | 张三 |
| 2 | 李四 |
+-----+-------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from course;
+------+-------+
| cid | cname |
+------+-------+
| 1001 | Java |
| 1002 | MySQL |
+------+-------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student_course values( 1 , 1001 , 89 ),( 1 , 1002 , 90 ),( 2 , 1001 , 88 ),( 2 , 1002 , 56 );
</code></pre></div>
<h4 id="_61">再举例<a class="headerlink" href="#_61" title="Permanent link">&para;</a></h4>
<h3 id="4-6">4. 6 删除主键约束<a class="headerlink" href="#4-6" title="Permanent link">&para;</a></h3>
<h4 id="_62">举例：<a class="headerlink" href="#_62" title="Permanent link">&para;</a></h4>
<h4 id="_63">说明：删除主键约束，不需要指定主键名，因为一个表只有一个主键，删除主键约束后，非空还存<a class="headerlink" href="#_63" title="Permanent link">&para;</a></h4>
<h4 id="_64">在。<a class="headerlink" href="#_64" title="Permanent link">&para;</a></h4>
<h2 id="5-auto_increment">5. 自增列：AUTO_INCREMENT<a class="headerlink" href="#5-auto_increment" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from student_course;
+-----+------+-------+
| sid | cid | score |
+-----+------+-------+
| 1 | 1001 | 89 |
| 1 | 1002 | 90 |
| 2 | 1001 | 88 |
| 2 | 1002 | 56 |
+-----+------+-------+
4 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into student_course values( 1 , 1001 , 100 );
ERROR 1062 ( 23000 ): Duplicate entry &#39;1-1001&#39; for key &#39;PRIMARY&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; desc student_course;
+-------+---------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-------+---------+------+-----+---------+-------+
| sid | int( 11 ) | NO | PRI | NULL | |
| cid | int( 11 ) | NO | PRI | NULL | |
| score | int( 11 ) | YES | | NULL | |
+-------+---------+------+-----+---------+-------+
3 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>CREATE TABLE emp6(
id INT NOT NULL,
NAME VARCHAR( 20 ),
pwd VARCHAR( 15 ),
CONSTRAINT emp7_pk PRIMARY KEY(NAME,pwd)
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table 表名称 drop primary key;
</code></pre></div>
<div class="highlight"><pre><span></span><code>ALTER TABLE student DROP PRIMARY KEY;
</code></pre></div>
<div class="highlight"><pre><span></span><code>ALTER TABLE emp5 DROP PRIMARY KEY;
</code></pre></div>
<h3 id="5-1">5. 1 作用<a class="headerlink" href="#5-1" title="Permanent link">&para;</a></h3>
<h4 id="_65">某个字段的值自增<a class="headerlink" href="#_65" title="Permanent link">&para;</a></h4>
<h3 id="5-2">5. 2 关键字<a class="headerlink" href="#5-2" title="Permanent link">&para;</a></h3>
<h4 id="auto_increment">auto_increment<a class="headerlink" href="#auto_increment" title="Permanent link">&para;</a></h4>
<h3 id="5-3">5. 3 特点和要求<a class="headerlink" href="#5-3" title="Permanent link">&para;</a></h3>
<h4 id="1_4">（ 1 ）一个表最多只能有一个自增长列<a class="headerlink" href="#1_4" title="Permanent link">&para;</a></h4>
<h4 id="2_5">（ 2 ）当需要产生唯一标识符或顺序值时，可设置自增长<a class="headerlink" href="#2_5" title="Permanent link">&para;</a></h4>
<h4 id="3_1">（ 3 ）自增长列约束的列必须是键列（主键列，唯一键列）<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h4>
<h4 id="4">（ 4 ）自增约束的列的数据类型必须是整数类型<a class="headerlink" href="#4" title="Permanent link">&para;</a></h4>
<h4 id="5-0-null">（ 5 ）如果自增列指定了 0 和 null，会在当前最大值的基础上自增；如果自增列手动指定了具体值，直接<a class="headerlink" href="#5-0-null" title="Permanent link">&para;</a></h4>
<h4 id="_66">赋值为具体值。<a class="headerlink" href="#_66" title="Permanent link">&para;</a></h4>
<h4 id="_67">错误演示：<a class="headerlink" href="#_67" title="Permanent link">&para;</a></h4>
<h3 id="5-4">5. 4 如何指定自增约束<a class="headerlink" href="#5-4" title="Permanent link">&para;</a></h3>
<h4 id="1_5">（ 1 ）建表时<a class="headerlink" href="#1_5" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>create table employee(
eid int auto_increment,
ename varchar( 20 )
);
# ERROR 1075 (42000): Incorrect table definition; there can be only one auto column
and it must be defined as a key
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table employee(
eid int primary key,
ename varchar( 20 ) unique key auto_increment
);
# ERROR 1063 (42000): Incorrect column specifier for column &#39;ename&#39; 因为ename不是整数类
型
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table 表名称(
字段名 数据类型 primary key auto_increment,
字段名 数据类型 unique key not null,
字段名 数据类型 unique key,
字段名 数据类型 not null default 默认值,
);
create table 表名称(
字段名 数据类型 default 默认值 ,
字段名 数据类型 unique key auto_increment,
字段名 数据类型 not null default 默认值,,
primary key(字段名)
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table employee(
eid int primary key auto_increment,
ename varchar( 20 )
);
</code></pre></div>
<h4 id="2_6">（ 2 ）建表后<a class="headerlink" href="#2_6" title="Permanent link">&para;</a></h4>
<h4 id="_68">例如：<a class="headerlink" href="#_68" title="Permanent link">&para;</a></h4>
<h3 id="5-5">5. 5 如何删除自增约束<a class="headerlink" href="#5-5" title="Permanent link">&para;</a></h3>
<h3 id="5-6-mysql-8-0">5. 6 MySQL 8. 0 新特性—自增变量的持久化<a class="headerlink" href="#5-6-mysql-8-0" title="Permanent link">&para;</a></h3>
<h4 id="mysql-80auto_incrementmaxprimary-key1mysql">在MySQL 8.0之前，自增主键AUTO_INCREMENT的值如果大于max(primary key)+1，在MySQL重启后，会重<a class="headerlink" href="#mysql-80auto_incrementmaxprimary-key1mysql" title="Permanent link">&para;</a></h4>
<h4 id="auto_incrementmaxprimary-key1">置AUTO_INCREMENT=max(primary key)+1，这种现象在某些情况下会导致业务主键冲突或者其他难以发<a class="headerlink" href="#auto_incrementmaxprimary-key1" title="Permanent link">&para;</a></h4>
<h4 id="mysql-57">现的问题。 下面通过案例来对比不同的版本中自增变量是否持久化。 在MySQL 5.7版本中，测试步骤如<a class="headerlink" href="#mysql-57" title="Permanent link">&para;</a></h4>
<h4 id="id">下： 创建的数据表中包含自增主键的id字段，语句如下：<a class="headerlink" href="#id" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>mysql&gt; desc employee;
+-------+-------------+------+-----+---------+----------------+
| Field | Type | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+----------------+
| eid | int( 11 ) | NO | PRI | NULL | auto_increment |
| ename | varchar( 20 ) | YES | | NULL | |
+-------+-------------+------+-----+---------+----------------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table 表名称 modify 字段名 数据类型 auto_increment;
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table employee(
eid int primary key ,
ename varchar( 20 )
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table employee modify eid int auto_increment;
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; desc employee;
+-------+-------------+------+-----+---------+----------------+
| Field | Type | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+----------------+
| eid | int( 11 ) | NO | PRI | NULL | auto_increment |
| ename | varchar( 20 ) | YES | | NULL | |
+-------+-------------+------+-----+---------+----------------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>#alter table 表名称 modify 字段名 数据类型 auto_increment;#给这个字段增加自增约束
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table 表名称 modify 字段名 数据类型; #去掉auto_increment相当于删除
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table employee modify eid int;
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; desc employee;
+-------+-------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| eid | int( 11 ) | NO | PRI | NULL | |
| ename | varchar( 20 ) | YES | | NULL | |
+-------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)
</code></pre></div>
<h4 id="4_1">插入 4 个空值，执行如下：<a class="headerlink" href="#4_1" title="Permanent link">&para;</a></h4>
<h4 id="test1">查询数据表test1中的数据，结果如下：<a class="headerlink" href="#test1" title="Permanent link">&para;</a></h4>
<h4 id="id-4">删除id为 4 的记录，语句如下：<a class="headerlink" href="#id-4" title="Permanent link">&para;</a></h4>
<h4 id="_69">再次插入一个空值，语句如下：<a class="headerlink" href="#_69" title="Permanent link">&para;</a></h4>
<h4 id="test1_1">查询此时数据表test1中的数据，结果如下：<a class="headerlink" href="#test1_1" title="Permanent link">&para;</a></h4>
<h4 id="id-4-4">从结果可以看出，虽然删除了id为 4 的记录，但是再次插入空值时，并没有重用被删除的 4 ，而是分配了<a class="headerlink" href="#id-4-4" title="Permanent link">&para;</a></h4>
<h4 id="5-id-5">5 。 删除id为 5 的记录，结果如下：<a class="headerlink" href="#5-id-5" title="Permanent link">&para;</a></h4>
<h4 id="_70">重启数据库 ，重新插入一个空值。<a class="headerlink" href="#_70" title="Permanent link">&para;</a></h4>
<h4 id="test1_2">再次查询数据表test1中的数据，结果如下：<a class="headerlink" href="#test1_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>CREATE TABLE test1(
id INT PRIMARY KEY AUTO_INCREMENT
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>INSERT INTO test
VALUES( 0 ),( 0 ),( 0 ),( 0 );
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM test1;
+----+
| id |
+----+
| 1 |
| 2 |
| 3 |
| 4 |
+----+
4 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>DELETE FROM test1 WHERE id = 4 ;
</code></pre></div>
<div class="highlight"><pre><span></span><code>INSERT INTO test1 VALUES( 0 );
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM test1;
+----+
| id |
+----+
| 1 |
| 2 |
| 3 |
| 5 |
+----+
4 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>DELETE FROM test1 where id= 5 ;
</code></pre></div>
<div class="highlight"><pre><span></span><code>INSERT INTO test1 values( 0 );
</code></pre></div>
<h4 id="0-4-6">从结果可以看出，新插入的 0 值分配的是 4 ，按照重启前的操作逻辑，此处应该分配 6 。出现上述结果的主<a class="headerlink" href="#0-4-6" title="Permanent link">&para;</a></h4>
<h4 id="mysql-5-7-innodb">要原因是自增主键没有持久化。 在MySQL 5. 7 系统中，对于自增主键的分配规则，是由InnoDB数据字典<a class="headerlink" href="#mysql-5-7-innodb" title="Permanent link">&para;</a></h4>
<h4 id="_71">内部一个计数器来决定的，而该计数器只在内存中维护，并不会持久化到磁盘中。当数据库重启时，该<a class="headerlink" href="#_71" title="Permanent link">&para;</a></h4>
<h4 id="_72">计数器会被初始化。<a class="headerlink" href="#_72" title="Permanent link">&para;</a></h4>
<h4 id="mysql-8-0">在MySQL 8. 0 版本中，上述测试步骤最后一步的结果如下：<a class="headerlink" href="#mysql-8-0" title="Permanent link">&para;</a></h4>
<h4 id="_73">从结果可以看出，自增变量已经持久化了。<a class="headerlink" href="#_73" title="Permanent link">&para;</a></h4>
<h4 id="mysql-8-0_1">MySQL 8. 0 将自增主键的计数器持久化到重做日志中。每次计数器发生改变，都会将其写入重做日志<a class="headerlink" href="#mysql-8-0_1" title="Permanent link">&para;</a></h4>
<h4 id="innodb">中。如果数据库重启，InnoDB会根据重做日志中的信息来初始化计数器的内存值。<a class="headerlink" href="#innodb" title="Permanent link">&para;</a></h4>
<h2 id="6-foreign-key">6. FOREIGN KEY 约束<a class="headerlink" href="#6-foreign-key" title="Permanent link">&para;</a></h2>
<h3 id="6-1">6. 1 作用<a class="headerlink" href="#6-1" title="Permanent link">&para;</a></h3>
<h4 id="_74">限定某个表的某个字段的引用完整性。<a class="headerlink" href="#_74" title="Permanent link">&para;</a></h4>
<h4 id="_75">比如：员工表的员工所在部门的选择，必须在部门表能找到对应的部分。<a class="headerlink" href="#_75" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM test1;
+----+
| id |
+----+
| 1 |
| 2 |
| 3 |
| 4 |
+----+
4 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM test1;
+----+
| id |
+----+
| 1 |
| 2 |
| 3 |
| 6 |
+----+
4 rows in set (0.00 sec)
</code></pre></div>
<h3 id="6-2">6. 2 关键字<a class="headerlink" href="#6-2" title="Permanent link">&para;</a></h3>
<h4 id="foreign-key_1">FOREIGN KEY<a class="headerlink" href="#foreign-key_1" title="Permanent link">&para;</a></h4>
<h3 id="6-3">6. 3 主表和从表/父表和子表<a class="headerlink" href="#6-3" title="Permanent link">&para;</a></h3>
<h4 id="_76">主表（父表）：被引用的表，被参考的表<a class="headerlink" href="#_76" title="Permanent link">&para;</a></h4>
<h4 id="_77">从表（子表）：引用别人的表，参考别人的表<a class="headerlink" href="#_77" title="Permanent link">&para;</a></h4>
<h4 id="_78">例如：员工表的员工所在部门这个字段的值要参考部门表：部门表是主表，员工表是从表。<a class="headerlink" href="#_78" title="Permanent link">&para;</a></h4>
<h4 id="_79">例如：学生表、课程表、选课表：选课表的学生和课程要分别参考学生表和课程表，学生表和课程表是<a class="headerlink" href="#_79" title="Permanent link">&para;</a></h4>
<h4 id="_80">主表，选课表是从表。<a class="headerlink" href="#_80" title="Permanent link">&para;</a></h4>
<h3 id="6-4">6. 4 特点<a class="headerlink" href="#6-4" title="Permanent link">&para;</a></h3>
<h4 id="1_6">（ 1 ）从表的外键列，必须引用/参考主表的主键或唯一约束的列<a class="headerlink" href="#1_6" title="Permanent link">&para;</a></h4>
<h4 id="_81">为什么？因为被依赖/被参考的值必须是唯一的<a class="headerlink" href="#_81" title="Permanent link">&para;</a></h4>
<h4 id="2_7">（ 2 ）在创建外键约束时，如果不给外键约束命名， 默认名不是列名，而是自动产生一个外键名 （例如<a class="headerlink" href="#2_7" title="Permanent link">&para;</a></h4>
<h4 id="student_ibfk_1">student_ibfk_1;），也可以指定外键约束名。<a class="headerlink" href="#student_ibfk_1" title="Permanent link">&para;</a></h4>
<h4 id="3-create">（ 3 ）创建(CREATE)表时就指定外键约束的话，先创建主表，再创建从表<a class="headerlink" href="#3-create" title="Permanent link">&para;</a></h4>
<h4 id="4_2">（ 4 ）删表时，先删从表（或先删除外键约束），再删除主表<a class="headerlink" href="#4_2" title="Permanent link">&para;</a></h4>
<h4 id="5_1">（ 5 ）当主表的记录被从表参照时，主表的记录将不允许删除，如果要删除数据，需要先删除从表中依赖<a class="headerlink" href="#5_1" title="Permanent link">&para;</a></h4>
<h4 id="_82">该记录的数据，然后才可以删除主表的数据<a class="headerlink" href="#_82" title="Permanent link">&para;</a></h4>
<h4 id="6">（ 6 ）在“从表”中指定外键约束，并且一个表可以建立多个外键约束<a class="headerlink" href="#6" title="Permanent link">&para;</a></h4>
<h4 id="7">（ 7 ）从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样，逻辑意义一致。如果类<a class="headerlink" href="#7" title="Permanent link">&para;</a></h4>
<h4 id="error-1005-hy000-cant-create">型不一样，创建子表时，就会出现错误“ERROR 1005 (HY000): Can't create<a class="headerlink" href="#error-1005-hy000-cant-create" title="Permanent link">&para;</a></h4>
<h4 id="tabledatabasetablenameerrno-150">table'database.tablename'(errno: 150)”。<a class="headerlink" href="#tabledatabasetablenameerrno-150" title="Permanent link">&para;</a></h4>
<h4 id="int">例如：都是表示部门编号，都是int类型。<a class="headerlink" href="#int" title="Permanent link">&para;</a></h4>
<h4 id="8">（ 8 ） 当创建外键约束时，系统默认会在所在的列上建立对应的普通索引 。但是索引名是外键的约束<a class="headerlink" href="#8" title="Permanent link">&para;</a></h4>
<h4 id="_83">名。（根据外键查询效率很高）<a class="headerlink" href="#_83" title="Permanent link">&para;</a></h4>
<h4 id="9">（ 9 ）删除外键约束后，必须手动删除对应的索引<a class="headerlink" href="#9" title="Permanent link">&para;</a></h4>
<h3 id="6-5">6. 5 添加外键约束<a class="headerlink" href="#6-5" title="Permanent link">&para;</a></h3>
<h4 id="1_7">（ 1 ）建表时<a class="headerlink" href="#1_7" title="Permanent link">&para;</a></h4>
<h4 id="2_8">（ 2 ）建表后<a class="headerlink" href="#2_8" title="Permanent link">&para;</a></h4>
<h4 id="_84">一般情况下，表与表的关联都是提前设计好了的，因此，会在创建表的时候就把外键约束定义好。不<a class="headerlink" href="#_84" title="Permanent link">&para;</a></h4>
<h4 id="_85">过，如果需要修改表的设计（比如添加新的字段，增加新的关联关系），但没有预先定义外键约束，那<a class="headerlink" href="#_85" title="Permanent link">&para;</a></h4>
<h4 id="_86">么，就要用修改表的方式来补充定义。<a class="headerlink" href="#_86" title="Permanent link">&para;</a></h4>
<h4 id="_87">格式：<a class="headerlink" href="#_87" title="Permanent link">&para;</a></h4>
<h4 id="_88">举例：<a class="headerlink" href="#_88" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>create table 主表名称(
字段 1 数据类型 primary key,
字段 2 数据类型
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table 从表名称(
字段 1 数据类型 primary key,
字段 2 数据类型,
[CONSTRAINT &lt;外键约束名称&gt;] FOREIGN KEY（从表的某个字段) references 主表名(被参考字段)
);
#(从表的某个字段)的数据类型必须与主表名(被参考字段)的数据类型一致，逻辑意义也一样
#(从表的某个字段)的字段名可以与主表名(被参考字段)的字段名一样，也可以不一样
</code></pre></div>
<h5 id="-foreign-key">-- FOREIGN KEY: 在表级指定子表中的列<a class="headerlink" href="#-foreign-key" title="Permanent link">&para;</a></h5>
<h5 id="-references">-- REFERENCES: 标示在父表中的列<a class="headerlink" href="#-references" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table dept( #主表
did int primary key, #部门编号
dname varchar( 50 ) #部门名称
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table emp(#从表
eid int primary key,  #员工编号
ename varchar( 5 ), #员工姓名
deptid int, #员工所在的部门
foreign key (deptid) references dept(did) #在从表中指定外键约束
#emp表的deptid和和dept表的did的数据类型一致，意义都是表示部门的编号
);
</code></pre></div>
<h5 id="_89">说明：<a class="headerlink" href="#_89" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>（ 1 ）主表dept必须先创建成功，然后才能创建emp表，指定外键成功。
（ 2 ）删除表时，先删除从表emp，再删除主表dept
</code></pre></div>
<h5 id="alter-table-add-constraint-foreign-key-references">ALTER TABLE 从表名 ADD [CONSTRAINT 约束名] FOREIGN KEY (从表的字段) REFERENCES 主表名(被引用<a class="headerlink" href="#alter-table-add-constraint-foreign-key-references" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>字段) [on update xx][on delete xx];
</code></pre></div>
<div class="highlight"><pre><span></span><code>ALTER TABLE emp
ADD [CONSTRAINT emp_dept_id_fk] FOREIGN KEY(dept_id) REFERENCES dept(dept_id);
</code></pre></div>
<h4 id="_90">举例：<a class="headerlink" href="#_90" title="Permanent link">&para;</a></h4>
<h3 id="6-6">6. 6 演示问题<a class="headerlink" href="#6-6" title="Permanent link">&para;</a></h3>
<h4 id="1_8">（ 1 ）失败：不是键列<a class="headerlink" href="#1_8" title="Permanent link">&para;</a></h4>
<h4 id="2_9">（ 2 ）失败：数据类型不一致<a class="headerlink" href="#2_9" title="Permanent link">&para;</a></h4>
<h4 id="3_2">（ 3 ）成功，两个表字段名一样<a class="headerlink" href="#3_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>create table dept(
did int primary key, #部门编号
dname varchar( 50 ) #部门名称
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table emp(
eid int primary key,  #员工编号
ename varchar( 5 ), #员工姓名
deptid int #员工所在的部门
);
#这两个表创建时，没有指定外键的话，那么创建顺序是随意
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table emp add foreign key (deptid) references dept(did);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table dept(
did int , #部门编号
dname varchar( 50 ) #部门名称
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table emp(
eid int primary key,  #员工编号
ename varchar( 5 ), #员工姓名
deptid int, #员工所在的部门
foreign key (deptid) references dept(did)
);
#ERROR 1215 (HY000): Cannot add foreign key constraint 原因是dept的did不是键列
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table dept(
did int primary key, #部门编号
dname varchar( 50 ) #部门名称
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table emp(
eid int primary key,  #员工编号
ename varchar( 5 ), #员工姓名
deptid char, #员工所在的部门
foreign key (deptid) references dept(did)
);
#ERROR 1215 (HY000): Cannot add foreign key constraint 原因是从表的deptid字段和主表的did字
段的数据类型不一致，并且要它俩的逻辑意义一致
</code></pre></div>
<h4 id="4_3">（ 4 ）添加、删除、修改问题<a class="headerlink" href="#4_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>create table dept(
did int primary key, #部门编号
dname varchar( 50 ) #部门名称
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table emp(
eid int primary key,  #员工编号
ename varchar( 5 ), #员工姓名
did int, #员工所在的部门
foreign key (did) references dept(did)
#emp表的deptid和和dept表的did的数据类型一致，意义都是表示部门的编号
#是否重名没问题，因为两个did在不同的表中
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table dept(
did int primary key, #部门编号
dname varchar( 50 ) #部门名称
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table emp(
eid int primary key,  #员工编号
ename varchar( 5 ), #员工姓名
deptid int, #员工所在的部门
foreign key (deptid) references dept(did)
#emp表的deptid和和dept表的did的数据类型一致，意义都是表示部门的编号
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into dept values( 1001 ,&#39;教学部&#39;);
insert into dept values( 1003 , &#39;财务部&#39;);
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into emp values( 1 ,&#39;张三&#39;, 1001 ); #添加从表记录成功，在添加这条记录时，要求部门表有 1001 部门
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into emp values( 2 ,&#39;李四&#39;, 1005 );#添加从表记录失败
ERROR 1452 ( 23000 ): Cannot add（添加） or update（修改） a child row: a foreign key
constraint fails (`atguigudb`.`emp`, CONSTRAINT `emp_ibfk_1` FOREIGN KEY (`deptid`)
REFERENCES `dept` (`did`)) 从表emp添加记录失败，因为主表dept没有 1005 部门
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from dept;
+------+--------+
| did | dname |
+------+--------+
| 1001 | 教学部 |
| 1003 | 财务部 |
+------+--------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from emp;
+-----+-------+--------+
| eid | ename | deptid |
+-----+-------+--------+
| 1 | 张三 | 1001 |
+-----+-------+--------+
1 row in set (0.00 sec)
</code></pre></div>
<h4 id="_91">总结：约束关系是针对双方的<a class="headerlink" href="#_91" title="Permanent link">&para;</a></h4>
<h4 id="_92">添加了外键约束后，主表的修改和删除数据受约束<a class="headerlink" href="#_92" title="Permanent link">&para;</a></h4>
<h4 id="_93">添加了外键约束后，从表的添加和修改数据受约束<a class="headerlink" href="#_93" title="Permanent link">&para;</a></h4>
<h4 id="_94">在从表上建立外键，要求主表必须存在<a class="headerlink" href="#_94" title="Permanent link">&para;</a></h4>
<h4 id="_95">删除主表时，要求从表从表先删除，或将从表中外键引用该主表的关系先删除<a class="headerlink" href="#_95" title="Permanent link">&para;</a></h4>
<h3 id="6-7">6. 7 约束等级<a class="headerlink" href="#6-7" title="Permanent link">&para;</a></h3>
<h4 id="cascadeupdatedeleteupdatedelete">Cascade方式：在父表上update/delete记录时，同步update/delete掉子表的匹配记录<a class="headerlink" href="#cascadeupdatedeleteupdatedelete" title="Permanent link">&para;</a></h4>
<h4 id="set-nullupdatedeletenull">Set null方式：在父表上update/delete记录时，将子表上匹配记录的列设为null，但是要注意子<a class="headerlink" href="#set-nullupdatedeletenull" title="Permanent link">&para;</a></h4>
<h4 id="not-null_4">表的外键列不能为not null<a class="headerlink" href="#not-null_4" title="Permanent link">&para;</a></h4>
<h4 id="no-actionupdatedelete">No action方式：如果子表中有匹配的记录，则不允许对父表对应候选键进行update/delete操作<a class="headerlink" href="#no-actionupdatedelete" title="Permanent link">&para;</a></h4>
<h4 id="restrictno-action">Restrict方式：同no action， 都是立即检查外键约束<a class="headerlink" href="#restrictno-action" title="Permanent link">&para;</a></h4>
<h4 id="set-defaultsqlyog">Set default方式（在可视化工具SQLyog中可能显示空白）：父表有变更时，子表将外键列设置<a class="headerlink" href="#set-defaultsqlyog" title="Permanent link">&para;</a></h4>
<h4 id="innodb_1">成一个默认的值，但Innodb不能识别<a class="headerlink" href="#innodb_1" title="Permanent link">&para;</a></h4>
<h4 id="restrict">如果没有指定等级，就相当于Restrict方式。<a class="headerlink" href="#restrict" title="Permanent link">&para;</a></h4>
<h4 id="on-update-cascade-on-delete-restrict">对于外键约束，最好是采用: ON UPDATE CASCADE ON DELETE RESTRICT 的方式。<a class="headerlink" href="#on-update-cascade-on-delete-restrict" title="Permanent link">&para;</a></h4>
<h4 id="1-1-on-update-cascade-on-delete-set-null">（ 1 ）演示 1 ：on update cascade on delete set null<a class="headerlink" href="#1-1-on-update-cascade-on-delete-set-null" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>update emp set deptid = 1002 where eid = 1 ;#修改从表失败
ERROR 1452 ( 23000 ): Cannot add（添加） or update（修改） a child row（子表的记录）: a
foreign key constraint fails（外键约束失败） (`atguigudb`.`emp`, CONSTRAINT `emp_ibfk_1`
FOREIGN KEY (`deptid`) REFERENCES `dept` (`did`))  #部门表did字段现在没有 1002 的值，所以员工
表中不能修改员工所在部门deptid为 1002
</code></pre></div>
<div class="highlight"><pre><span></span><code>update dept set did = 1002 where did = 1001 ;#修改主表失败
ERROR 1451 ( 23000 ): Cannot delete（删除） or update（修改） a parent row（父表的记录）: a
foreign key constraint fails (`atguigudb`.`emp`, CONSTRAINT `emp_ibfk_1` FOREIGN KEY
(`deptid`) REFERENCES `dept` (`did`)) #部门表did的 1001 字段已经被emp引用了，所以部门表的 1001 字
段就不能修改了。
</code></pre></div>
<div class="highlight"><pre><span></span><code>update dept set did = 1002 where did = 1003 ;#修改主表成功 因为部门表的 1003 部门没有被emp表引
用，所以可以修改
</code></pre></div>
<div class="highlight"><pre><span></span><code>delete from dept where did= 1001 ; #删除主表失败
ERROR 1451 ( 23000 ): Cannot delete（删除） or update（修改） a parent row（父表记录）: a
foreign key constraint fails (`atguigudb`.`emp`, CONSTRAINT `emp_ibfk_1` FOREIGN KEY
(`deptid`) REFERENCES `dept` (`did`))  #因为部门表did的 1001 字段已经被emp引用了，所以部门表的
1001 字段对应的记录就不能被删除
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table dept(
did int primary key, #部门编号
dname varchar( 50 ) #部门名称
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table emp(
eid int primary key,  #员工编号
ename varchar( 5 ), #员工姓名
deptid int, #员工所在的部门
foreign key (deptid) references dept(did)  on update cascade on delete set null
#把修改操作设置为级联修改等级，把删除操作设置为set null等级
);
</code></pre></div>
<p>insert into dept values( 1001 ,'教学部');
insert into dept values( 1002 , '财务部');
insert into dept values( 1003 , '咨询部');</p>
<p>insert into emp values( 1 ,'张三', 1001 ); #在添加这条记录时，要求部门表有 1001 部门
insert into emp values( 2 ,'李四', 1001 );
insert into emp values( 3 ,'王五', 1002 );</p>
<p>mysql&gt; select * from dept;</p>
<p>mysql&gt; select * from emp;</p>
<h5 id="1002-1004-1004">#修改主表成功，从表也跟着修改，修改了主表被引用的字段 1002 为 1004 ，从表的引用字段就跟着修改为 1004 了<a class="headerlink" href="#1002-1004-1004" title="Permanent link">&para;</a></h5>
<p>mysql&gt; update dept set did = 1004 where did = 1002 ;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1 Changed: 1 Warnings: 0</p>
<p>mysql&gt; select * from dept;
+------+--------+
| did | dname |
+------+--------+
| 1001 | 教学部 |
| 1003 | 咨询部 |
| 1004 | 财务部 | #原来是 1002 ，修改为 1004
+------+--------+
3 rows in set (0.00 sec)</p>
<p>mysql&gt; select * from emp;
+-----+-------+--------+
| eid | ename | deptid |
+-----+-------+--------+
| 1 | 张三 | 1001 |
| 2 | 李四 | 1001 |
| 3 | 王五 | 1004 | #原来是 1002 ，跟着修改为 1004
+-----+-------+--------+
3 rows in set (0.00 sec)</p>
<h1 id="null">删除主表的记录成功，从表对应的字段的值被修改为null<a class="headerlink" href="#null" title="Permanent link">&para;</a></h1>
<p>mysql&gt; delete from dept where did = 1001 ;
Query OK, 1 row affected (0.01 sec)</p>
<p>mysql&gt; select * from dept;
+------+--------+
| did | dname | #记录 1001 部门被删除了
+------+--------+
| 1003 | 咨询部 |
| 1004 | 财务部 |
+------+--------+
2 rows in set (0.00 sec)</p>
<p>mysql&gt; select * from emp;
+-----+-------+--------+
| eid | ename | deptid |
+-----+-------+--------+</p>
<h4 id="2-2-on-update-set-null-on-delete-cascade">（ 2 ）演示 2 ：on update set null on delete cascade<a class="headerlink" href="#2-2-on-update-set-null-on-delete-cascade" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>| 1 | 张三 | NULL | #原来引用 1001 部门的员工，deptid字段变为null
| 2 | 李四 | NULL |
| 3 | 王五 | 1004 |
+-----+-------+--------+
3 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table dept(
did int primary key, #部门编号
dname varchar( 50 ) #部门名称
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table emp(
eid int primary key,  #员工编号
ename varchar( 5 ), #员工姓名
deptid int, #员工所在的部门
foreign key (deptid) references dept(did)  on update set null on delete cascade
#把修改操作设置为set null等级，把删除操作设置为级联删除等级
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into dept values( 1001 ,&#39;教学部&#39;);
insert into dept values( 1002 , &#39;财务部&#39;);
insert into dept values( 1003 , &#39;咨询部&#39;);
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into emp values( 1 ,&#39;张三&#39;, 1001 ); #在添加这条记录时，要求部门表有 1001 部门
insert into emp values( 2 ,&#39;李四&#39;, 1001 );
insert into emp values( 3 ,&#39;王五&#39;, 1002 );
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from dept;
+------+--------+
| did | dname |
+------+--------+
| 1001 | 教学部 |
| 1002 | 财务部 |
| 1003 | 咨询部 |
+------+--------+
3 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from emp;
+-----+-------+--------+
| eid | ename | deptid |
+-----+-------+--------+
| 1 | 张三 | 1001 |
| 2 | 李四 | 1001 |
| 3 | 王五 | 1002 |
+-----+-------+--------+
3 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>#修改主表，从表对应的字段设置为null
mysql&gt; update dept set did = 1004 where did = 1002 ;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1 Changed: 1 Warnings: 0
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from dept;
+------+--------+
| did | dname |
</code></pre></div>
<h4 id="3-on-update-cascade-on-delete-cascade">（ 3 ）演示：on update cascade on delete cascade<a class="headerlink" href="#3-on-update-cascade-on-delete-cascade" title="Permanent link">&para;</a></h4>
<h5 id="-_2">+------+--------+<a class="headerlink" href="#-_2" title="Permanent link">&para;</a></h5>
<h5 id="1001">| 1001 | 教学部 |<a class="headerlink" href="#1001" title="Permanent link">&para;</a></h5>
<h5 id="1003">| 1003 | 咨询部 |<a class="headerlink" href="#1003" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>| 1004 | 财务部 | #原来did是 1002
+------+--------+
3 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from emp;
+-----+-------+--------+
| eid | ename | deptid |
+-----+-------+--------+
| 1 | 张三 | 1001 |
| 2 | 李四 | 1001 |
| 3 | 王五 | NULL | #原来deptid是 1002 ，因为部门表 1002 被修改了， 1002 没有对应的了，就设置为
null
+-----+-------+--------+
3 rows in set (0.00 sec)
</code></pre></div>
<h5 id="1001_1">#删除主表的记录成功，主表的 1001 行被删除了，从表相应的记录也被删除了<a class="headerlink" href="#1001_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>mysql&gt; delete from dept where did= 1001 ;
Query OK, 1 row affected (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from dept;
+------+--------+
| did | dname | #部门表中 1001 部门被删除
+------+--------+
| 1003 | 咨询部 |
| 1004 | 财务部 |
+------+--------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from emp;
+-----+-------+--------+
| eid | ename | deptid |#原来 1001 部门的员工也被删除了
+-----+-------+--------+
| 3 | 王五 | NULL |
+-----+-------+--------+
1 row in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table dept(
did int primary key, #部门编号
dname varchar( 50 ) #部门名称
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table emp(
eid int primary key,  #员工编号
ename varchar( 5 ), #员工姓名
deptid int, #员工所在的部门
foreign key (deptid) references dept(did)  on update cascade on delete cascade
#把修改操作设置为级联修改等级，把删除操作也设置为级联删除等级
);
</code></pre></div>
<p>insert into dept values( 1001 ,'教学部');
insert into dept values( 1002 , '财务部');
insert into dept values( 1003 , '咨询部');</p>
<p>insert into emp values( 1 ,'张三', 1001 ); #在添加这条记录时，要求部门表有 1001 部门
insert into emp values( 2 ,'李四', 1001 );
insert into emp values( 3 ,'王五', 1002 );</p>
<p>mysql&gt; select * from dept;
+------+--------+
| did | dname |
+------+--------+
| 1001 | 教学部 |
| 1002 | 财务部 |
| 1003 | 咨询部 |
+------+--------+
3 rows in set (0.00 sec)</p>
<p>mysql&gt; select * from emp;
+-----+-------+--------+
| eid | ename | deptid |
+-----+-------+--------+
| 1 | 张三 | 1001 |
| 2 | 李四 | 1001 |
| 3 | 王五 | 1002 |
+-----+-------+--------+
3 rows in set (0.00 sec)</p>
<h5 id="_96">#修改主表，从表对应的字段自动修改<a class="headerlink" href="#_96" title="Permanent link">&para;</a></h5>
<p>mysql&gt; update dept set did = 1004 where did = 1002 ;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1 Changed: 1 Warnings: 0</p>
<p>mysql&gt; select * from dept;
+------+--------+
| did | dname |
+------+--------+
| 1001 | 教学部 |
| 1003 | 咨询部 |
| 1004 | 财务部 | #部门 1002 修改为 1004
+------+--------+
3 rows in set (0.00 sec)</p>
<p>mysql&gt; select * from emp;
+-----+-------+--------+
| eid | ename | deptid |
+-----+-------+--------+
| 1 | 张三 | 1001 |
| 2 | 李四 | 1001 |
| 3 | 王五 | 1004 | #级联修改
+-----+-------+--------+
3 rows in set (0.00 sec)</p>
<h5 id="1001_2">#删除主表的记录成功，主表的 1001 行被删除了，从表相应的记录也被删除了<a class="headerlink" href="#1001_2" title="Permanent link">&para;</a></h5>
<p>mysql&gt; delete from dept where did= 1001 ;
Query OK, 1 row affected (0.00 sec)</p>
<h3 id="6-8">6. 8 删除外键约束<a class="headerlink" href="#6-8" title="Permanent link">&para;</a></h3>
<h4 id="_97">流程如下：<a class="headerlink" href="#_97" title="Permanent link">&para;</a></h4>
<h4 id="_98">举例：<a class="headerlink" href="#_98" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from dept;
+------+--------+
| did | dname | #1001部门被删除了
+------+--------+
| 1003 | 咨询部 |
| 1004 | 财务部 |
+------+--------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from emp;
+-----+-------+--------+
| eid | ename | deptid |  #1001部门的员工也被删除了
+-----+-------+--------+
| 3 | 王五 | 1004 |
+-----+-------+--------+
1 row in set (0.00 sec)
</code></pre></div>
<h5 id="1_9">( 1 )第一步先查看约束名和删除外键约束<a class="headerlink" href="#1_9" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>SELECT * FROM information_schema.table_constraints WHERE table_name = &#39;表名称&#39;;#查看某个
表的约束名
</code></pre></div>
<h5 id="alter-table-drop-foreign-key">ALTER TABLE 从表名 DROP FOREIGN KEY 外键约束名;<a class="headerlink" href="#alter-table-drop-foreign-key" title="Permanent link">&para;</a></h5>
<h5 id="2_10">（ 2 ）第二步查看索引名和删除索引。（注意，只能手动删除）<a class="headerlink" href="#2_10" title="Permanent link">&para;</a></h5>
<h5 id="show-index-from_1">SHOW INDEX FROM 表名称; #查看某个表的索引名<a class="headerlink" href="#show-index-from_1" title="Permanent link">&para;</a></h5>
<h5 id="alter-table-drop-index">ALTER TABLE 从表名 DROP INDEX 索引名;<a class="headerlink" href="#alter-table-drop-index" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>mysql&gt; SELECT * FROM information_schema.table_constraints WHERE table_name = &#39;emp&#39;;
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; alter table emp drop foreign key emp_ibfk_1;
Query OK, 0 rows affected (0.02 sec)
Records: 0 Duplicates: 0 Warnings: 0
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; show index from emp;
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; alter table emp drop index deptid;
Query OK, 0 rows affected (0.01 sec)
Records: 0 Duplicates: 0 Warnings: 0
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt;  show index from emp;
</code></pre></div>
<h3 id="6-9">6. 9 开发场景<a class="headerlink" href="#6-9" title="Permanent link">&para;</a></h3>
<h4 id="1_10">问题 1 ：如果两个表之间有关系（一对一、一对多），比如：员工表和部门表（一对多），它们之间是否<a class="headerlink" href="#1_10" title="Permanent link">&para;</a></h4>
<h4 id="_99">一定要建外键约束？<a class="headerlink" href="#_99" title="Permanent link">&para;</a></h4>
<h4 id="_100">答：不是的<a class="headerlink" href="#_100" title="Permanent link">&para;</a></h4>
<h4 id="2_11">问题 2 ：建和不建外键约束有什么区别？<a class="headerlink" href="#2_11" title="Permanent link">&para;</a></h4>
<h4 id="_101">答：建外键约束，你的操作（创建表、删除表、添加、修改、删除）会受到限制，从语法层面受到限<a class="headerlink" href="#_101" title="Permanent link">&para;</a></h4>
<h4 id="_102">制。例如：在员工表中不可能添加一个员工信息，它的部门的值在部门表中找不到。<a class="headerlink" href="#_102" title="Permanent link">&para;</a></h4>
<h4 id="_103">不建外键约束，你的操作（创建表、删除表、添加、修改、删除）不受限制，要保证数据的引用完整<a class="headerlink" href="#_103" title="Permanent link">&para;</a></h4>
<h4 id="java">性，只能依靠程序员的自觉，或者是在Java程序中进行限定。例如：在员工表中，可以添加一个员工的<a class="headerlink" href="#java" title="Permanent link">&para;</a></h4>
<h4 id="_104">信息，它的部门指定为一个完全不存在的部门。<a class="headerlink" href="#_104" title="Permanent link">&para;</a></h4>
<h4 id="3_3">问题 3 ：那么建和不建外键约束和查询有没有关系？<a class="headerlink" href="#3_3" title="Permanent link">&para;</a></h4>
<h4 id="_105">答：没有<a class="headerlink" href="#_105" title="Permanent link">&para;</a></h4>
<h4 id="mysql-sql">在 MySQL 里，外键约束是有成本的，需要消耗系统资源。对于大并发的 SQL 操作，有可能会不适<a class="headerlink" href="#mysql-sql" title="Permanent link">&para;</a></h4>
<h4 id="mysql_1">合。比如大型网站的中央数据库，可能会因为外键约束的系统开销而变得非常慢。所以， MySQL 允<a class="headerlink" href="#mysql_1" title="Permanent link">&para;</a></h4>
<h4 id="_106">许你不使用系统自带的外键约束，在应用层面完成检查数据一致性的逻辑。也就是说，即使你不<a class="headerlink" href="#_106" title="Permanent link">&para;</a></h4>
<h4 id="_107">用外键约束，也要想办法通过应用层面的附加逻辑，来实现外键约束的功能，确保数据的一致性。<a class="headerlink" href="#_107" title="Permanent link">&para;</a></h4>
<h3 id="6-10">6. 10 阿里开发规范<a class="headerlink" href="#6-10" title="Permanent link">&para;</a></h3>
<h4 id="_108">【强制】不得使用外键与级联，一切外键概念必须在应用层解决。<a class="headerlink" href="#_108" title="Permanent link">&para;</a></h4>
<h4 id="student_id-student_id">说明：（概念解释）学生表中的 student_id 是主键，那么成绩表中的 student_id 则为外键。如果更新学<a class="headerlink" href="#student_id-student_id" title="Permanent link">&para;</a></h4>
<h4 id="student_id-student_id_1">生表中的 student_id，同时触发成绩表中的 student_id 更新，即为级联更新。外键与级联更新适用于单<a class="headerlink" href="#student_id-student_id_1" title="Permanent link">&para;</a></h4>
<h4 id="_109">机低并发，不适合分布式、高并发集群；级联更新是强阻塞，存在数据库更新风暴的风险；外键影响<a class="headerlink" href="#_109" title="Permanent link">&para;</a></h4>
<h4 id="_110">数据库的插入速度。<a class="headerlink" href="#_110" title="Permanent link">&para;</a></h4>
<h2 id="7-check">7. CHECK 约束<a class="headerlink" href="#7-check" title="Permanent link">&para;</a></h2>
<h3 id="7-1">7. 1 作用<a class="headerlink" href="#7-1" title="Permanent link">&para;</a></h3>
<h4 id="xx">检查某个字段的值是否符号xx要求，一般指的是值的范围<a class="headerlink" href="#xx" title="Permanent link">&para;</a></h4>
<h3 id="2_12">2 、关键字<a class="headerlink" href="#2_12" title="Permanent link">&para;</a></h3>
<h4 id="check_1">CHECK<a class="headerlink" href="#check_1" title="Permanent link">&para;</a></h4>
<h3 id="3-mysql-5-7">3 、说明：MySQL 5. 7 不支持<a class="headerlink" href="#3-mysql-5-7" title="Permanent link">&para;</a></h3>
<h4 id="mysql57-checkcheck">MySQL5.7 可以使用check约束，但check约束对数据验证没有任何作用。添加数据时，没有任何错误或警<a class="headerlink" href="#mysql57-checkcheck" title="Permanent link">&para;</a></h4>
<h4 id="_111">告<a class="headerlink" href="#_111" title="Permanent link">&para;</a></h4>
<h4 id="mysql-80check">但是 MySQL 8.0中可以使用check约束了 。<a class="headerlink" href="#mysql-80check" title="Permanent link">&para;</a></h4>
<h4 id="_112">再举例<a class="headerlink" href="#_112" title="Permanent link">&para;</a></h4>
<h4 id="_113">再举例<a class="headerlink" href="#_113" title="Permanent link">&para;</a></h4>
<h4 id="_114">再举例<a class="headerlink" href="#_114" title="Permanent link">&para;</a></h4>
<h2 id="8-default">8. DEFAULT约束<a class="headerlink" href="#8-default" title="Permanent link">&para;</a></h2>
<h3 id="8-1">8. 1 作用<a class="headerlink" href="#8-1" title="Permanent link">&para;</a></h3>
<h4 id="_115">给某个字段/某列指定默认值，一旦设置默认值，在插入数据时，如果此字段没有显式赋值，则赋值为默<a class="headerlink" href="#_115" title="Permanent link">&para;</a></h4>
<h4 id="_116">认值。<a class="headerlink" href="#_116" title="Permanent link">&para;</a></h4>
<h3 id="8-2">8. 2 关键字<a class="headerlink" href="#8-2" title="Permanent link">&para;</a></h3>
<h4 id="default_1">DEFAULT<a class="headerlink" href="#default_1" title="Permanent link">&para;</a></h4>
<h3 id="8-3">8. 3 如何给字段加默认值<a class="headerlink" href="#8-3" title="Permanent link">&para;</a></h3>
<h4 id="1_11">（ 1 ）建表时<a class="headerlink" href="#1_11" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>create table employee(
eid int primary key,
ename varchar( 5 ),
gender char check (&#39;男&#39; or &#39;女&#39;)
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into employee values( 1 ,&#39;张三&#39;,&#39;妖&#39;);
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from employee;
+-----+-------+--------+
| eid | ename | gender |
+-----+-------+--------+
| 1 | 张三 | 妖 |
+-----+-------+--------+
1 row in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>CREATE TABLE temp(
id INT AUTO_INCREMENT,
NAME VARCHAR( 20 ),
age INT CHECK(age &gt; 20 ),
PRIMARY KEY(id)
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>age tinyint check(age &gt; 20 ) 或 sex char( 2 ) check(sex in(‘男’,’女’))
</code></pre></div>
<div class="highlight"><pre><span></span><code>CHECK(height&gt;= 0 AND height&lt; 3 )
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table 表名称(
字段名 数据类型 primary key,
字段名 数据类型 unique key not null,
字段名 数据类型 unique key,
字段名 数据类型 not null default 默认值,
);
create table 表名称(
</code></pre></div>
<h4 id="_117">再举例：<a class="headerlink" href="#_117" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>字段名 数据类型 default 默认值 ,
字段名 数据类型 not null default 默认值,
字段名 数据类型 not null default 默认值,
primary key(字段名),
unique key(字段名)
);
</code></pre></div>
<h5 id="_118">说明：默认值约束一般不在唯一键和主键列上加<a class="headerlink" href="#_118" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>create table employee(
eid int primary key,
ename varchar( 20 ) not null,
gender char default &#39;男&#39;,
tel char( 11 ) not null default &#39;&#39; #默认是空字符串
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; desc employee;
+--------+-------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+--------+-------------+------+-----+---------+-------+
| eid | int( 11 ) | NO | PRI | NULL | |
| ename | varchar( 20 ) | NO | | NULL | |
| gender | char( 1 ) | YES | | 男 | |
| tel | char( 11 ) | NO | | | |
+--------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into employee values( 1 ,&#39;汪飞&#39;,&#39;男&#39;,&#39;13700102535&#39;); #成功
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from employee;
+-----+-------+--------+-------------+
| eid | ename | gender | tel |
+-----+-------+--------+-------------+
| 1 | 汪飞 | 男 | 13700102535 |
+-----+-------+--------+-------------+
1 row in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into employee(eid,ename) values( 2 ,&#39;天琪&#39;); #成功
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; select * from employee;
+-----+-------+--------+-------------+
| eid | ename | gender | tel |
+-----+-------+--------+-------------+
| 1 | 汪飞 | 男 | 13700102535 |
| 2 | 天琪 | 男 | |
+-----+-------+--------+-------------+
2 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>insert into employee(eid,ename) values( 3 ,&#39;二虎&#39;);
#ERROR 1062 (23000): Duplicate entry &#39;&#39; for key &#39;tel&#39;
#如果tel有唯一性约束的话会报错，如果tel没有唯一性约束，可以添加成功
</code></pre></div>
<h4 id="2_13">（ 2 ）建表后<a class="headerlink" href="#2_13" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>CREATE TABLE myemp(
id INT AUTO_INCREMENT PRIMARY KEY,
NAME VARCHAR( 15 ),
salary DOUBLE( 10 , 2 ) DEFAULT 2000
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table 表名称 modify 字段名 数据类型 default 默认值;
</code></pre></div>
<h5 id="_119">#如果这个字段原来有非空约束，你还保留非空约束，那么在加默认值约束时，还得保留非空约束，否则非空约束就被<a class="headerlink" href="#_119" title="Permanent link">&para;</a></h5>
<h5 id="_120">删除了<a class="headerlink" href="#_120" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>#同理，在给某个字段加非空约束也一样，如果这个字段原来有默认值约束，你想保留，也要在modify语句中保留默
认值约束，否则就删除了
alter table 表名称 modify 字段名 数据类型 default 默认值 not null;
</code></pre></div>
<div class="highlight"><pre><span></span><code>create table employee(
eid int primary key,
ename varchar( 20 ),
gender char,
tel char( 11 ) not null
);
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; desc employee;
+--------+-------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+--------+-------------+------+-----+---------+-------+
| eid | int( 11 ) | NO | PRI | NULL | |
| ename | varchar( 20 ) | YES | | NULL | |
| gender | char( 1 ) | YES | | NULL | |
| tel | char( 11 ) | NO | | NULL | |
+--------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table employee modify gender char default &#39;男&#39;;  #给gender字段增加默认值约束
alter table employee modify tel char( 11 ) default &#39;&#39;; #给tel字段增加默认值约束
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; desc employee;
+--------+-------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+--------+-------------+------+-----+---------+-------+
| eid | int( 11 ) | NO | PRI | NULL | |
| ename | varchar( 20 ) | YES | | NULL | |
| gender | char( 1 ) | YES | | 男 | |
| tel | char( 11 ) | YES | | | |
+--------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table employee modify tel char( 11 ) default &#39;&#39; not null;#给tel字段增加默认值约束，并
保留非空约束
</code></pre></div>
<h3 id="8-4">8. 4 如何删除默认值约束<a class="headerlink" href="#8-4" title="Permanent link">&para;</a></h3>
<h2 id="9_1">9. 面试<a class="headerlink" href="#9_1" title="Permanent link">&para;</a></h2>
<h4 id="1-not-null-default-default-0">面试 1 、为什么建表时，加 not null default '' 或 default 0<a class="headerlink" href="#1-not-null-default-default-0" title="Permanent link">&para;</a></h4>
<h4 id="null_1">答：不想让表中出现null值。<a class="headerlink" href="#null_1" title="Permanent link">&para;</a></h4>
<h4 id="2-null">面试 2 、为什么不想要 null 的值<a class="headerlink" href="#2-null" title="Permanent link">&para;</a></h4>
<h4 id="1-nullis-null-is-not-null">答:（ 1 ）不好比较。null是一种特殊值，比较时只能用专门的is null 和 is not null来比较。碰到运算符，通<a class="headerlink" href="#1-nullis-null-is-not-null" title="Permanent link">&para;</a></h4>
<h4 id="null_2">常返回null。<a class="headerlink" href="#null_2" title="Permanent link">&para;</a></h4>
<h4 id="2-not-null-default-default-0">（ 2 ）效率不高。影响提高索引效果。因此，我们往往在建表时 not null default '' 或 default 0<a class="headerlink" href="#2-not-null-default-default-0" title="Permanent link">&para;</a></h4>
<h4 id="3-auto_increment-1-mysqlauto_increment">面试 3 、带AUTO_INCREMENT约束的字段值是从 1 开始的吗？ 在MySQL中，默认AUTO_INCREMENT的初始<a class="headerlink" href="#3-auto_increment-1-mysqlauto_increment" title="Permanent link">&para;</a></h4>
<h4 id="1-1-auto_increment">值是 1 ，每新增一条记录，字段值自动加 1 。设置自增属性（AUTO_INCREMENT）的时候，还可以指定第<a class="headerlink" href="#1-1-auto_increment" title="Permanent link">&para;</a></h4>
<h4 id="_121">一条插入记录的自增字段的值，这样新插入的记录的自增字段值从初始值开始递增，如在表中插入第一<a class="headerlink" href="#_121" title="Permanent link">&para;</a></h4>
<h4 id="id-5-id-6">条记录，同时指定id值为 5 ，则以后插入的记录的id值就会从 6 开始往上增加。添加主键约束时，往往需要<a class="headerlink" href="#id-5-id-6" title="Permanent link">&para;</a></h4>
<h4 id="_122">设置字段自动增加属性。<a class="headerlink" href="#_122" title="Permanent link">&para;</a></h4>
<h4 id="4-foreign-key">面试 4 、并不是每个表都可以任意选择存储引擎？ 外键约束（FOREIGN KEY）不能跨引擎使用。<a class="headerlink" href="#4-foreign-key" title="Permanent link">&para;</a></h4>
<h4 id="mysql_2">MySQL支持多种存储引擎，每一个表都可以指定一个不同的存储引擎，需要注意的是：外键约束是用来<a class="headerlink" href="#mysql_2" title="Permanent link">&para;</a></h4>
<h4 id="_123">保证数据的参照完整性的，如果表之间需要关联外键，却指定了不同的存储引擎，那么这些表之间是不<a class="headerlink" href="#_123" title="Permanent link">&para;</a></h4>
<h4 id="_124">能创建外键约束的。所以说，存储引擎的选择也不完全是随意的。<a class="headerlink" href="#_124" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>mysql&gt; desc employee;
+--------+-------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+--------+-------------+------+-----+---------+-------+
| eid | int( 11 ) | NO | PRI | NULL | |
| ename | varchar( 20 ) | YES | | NULL | |
| gender | char( 1 ) | YES | | 男 | |
| tel | char( 11 ) | NO | | | |
+--------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table 表名称 modify 字段名 数据类型 ;#删除默认值约束，也不保留非空约束
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table 表名称 modify 字段名 数据类型 not null; #删除默认值约束，保留非空约束
</code></pre></div>
<div class="highlight"><pre><span></span><code>alter table employee modify gender char; #删除gender字段默认值约束，如果有非空约束，也一并删除
alter table employee modify tel char( 11 )  not null;#删除tel字段默认值约束，保留非空约束
</code></pre></div>
<div class="highlight"><pre><span></span><code>mysql&gt; desc employee;
+--------+-------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+--------+-------------+------+-----+---------+-------+
| eid | int( 11 ) | NO | PRI | NULL | |
| ename | varchar( 20 ) | YES | | NULL | |
| gender | char( 1 ) | YES | | NULL | |
| tel | char( 11 ) | NO | | NULL | |
+--------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            回到页面顶部
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.share", "header.autohide"], "search": "../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
        <script src="../../../../../mkdocs/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>